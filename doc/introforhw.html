<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Hao Liang" />

<meta name="date" content="2021-12-20" />

<title>Introduction to 21019 homework</title>

<script src="data:application/javascript;base64,Ly8gUGFuZG9jIDIuOSBhZGRzIGF0dHJpYnV0ZXMgb24gYm90aCBoZWFkZXIgYW5kIGRpdi4gV2UgcmVtb3ZlIHRoZSBmb3JtZXIgKHRvCi8vIGJlIGNvbXBhdGlibGUgd2l0aCB0aGUgYmVoYXZpb3Igb2YgUGFuZG9jIDwgMi44KS4KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKGUpIHsKICB2YXIgaHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCJkaXYuc2VjdGlvbltjbGFzcyo9J2xldmVsJ10gPiA6Zmlyc3QtY2hpbGQiKTsKICB2YXIgaSwgaCwgYTsKICBmb3IgKGkgPSAwOyBpIDwgaHMubGVuZ3RoOyBpKyspIHsKICAgIGggPSBoc1tpXTsKICAgIGlmICghL15oWzEtNl0kL2kudGVzdChoLnRhZ05hbWUpKSBjb250aW51ZTsgIC8vIGl0IHNob3VsZCBiZSBhIGhlYWRlciBoMS1oNgogICAgYSA9IGguYXR0cmlidXRlczsKICAgIHdoaWxlIChhLmxlbmd0aCA+IDApIGgucmVtb3ZlQXR0cmlidXRlKGFbMF0ubmFtZSk7CiAgfQp9KTsK"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="data:text/css,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">Introduction to 21019 homework</h1>
<h4 class="author">Hao Liang</h4>
<h4 class="date">2021-12-20</h4>



<div id="hw0" class="section level2">
<h2>HW0</h2>
<div id="question" class="section level3">
<h3>Question</h3>
<p>Use knitr to produce at least 3 examples(texts, figures and tables).</p>
</div>
<div id="answer" class="section level3">
<h3>Answer</h3>
<div id="text" class="section level4">
<h4>Text</h4>
<p>示例文本如下:</p>
<p><span class="math inline">\(\frac{1}{n}\sum_{i=1}^{n}(x_i-\bar{x})^2=\frac{1}{n}\sum_{i=1}^{n}x_i^2-\bar{x}^2\)</span></p>
<p>即样本的方差等于样本平方的均值减去均值的平方。</p>
</div>
<div id="figures" class="section level4">
<h4>Figures</h4>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#生成100以内正整数简单随机不放回抽样50例，记为y，x为1至50的自然数</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>x<span class="ot">=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">50</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>y<span class="ot">=</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>,<span class="at">size=</span><span class="dv">50</span>,<span class="at">replace =</span> F)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co">#生成y的直方图</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(y)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">#生成x,y的散点图</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x,y)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="tables" class="section level4">
<h4>Tables</h4>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">#生成x和y的一元线性回归模型</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>model<span class="ot">&lt;-</span><span class="fu">lm</span>(x<span class="sc">~</span>y)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co">#输出统计量表格</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">summary</span>(model)<span class="sc">$</span>coef)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Estimate</th>
<th align="right">Std. Error</th>
<th align="right">t value</th>
<th align="right">Pr(&gt;|t|)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">24.3687583</td>
<td align="right">4.3664431</td>
<td align="right">5.5809175</td>
<td align="right">0.0000011</td>
</tr>
<tr class="even">
<td align="left">y</td>
<td align="right">0.0207796</td>
<td align="right">0.0705113</td>
<td align="right">0.2946989</td>
<td align="right">0.7694947</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="hw1" class="section level2">
<h2>HW1</h2>
<div id="题3.4" class="section level3">
<h3>题3.4</h3>
<p>The Rayleigh density [156,Ch.18] is</p>
<p><span class="math display">\[
f(x)=\frac{x}{\sigma^2}e^{-x^2/(2\sigma^2)},\qquad x\geq0,\sigma&gt;0.
\]</span> Develop an algorithm to generate random samples from a Rayleigh(<span class="math inline">\(\sigma\)</span>) distribution. Generate Rayleigh(<span class="math inline">\(\sigma\)</span>) samples for several choices of <span class="math inline">\(\sigma\)</span>&gt; 0 and check that the mode of the generated samples is close to the theoretical mode <span class="math inline">\(\sigma\)</span> (check the histogram).</p>
<p>分布函数</p>
<p><span class="math display">\[
\begin{aligned}
F_X(x)=&amp;\int_{0}^xf(y)dy\\
=&amp;\int_{0}^x\frac{y}{\sigma^2}e^{-y^2/(2\sigma^2)}dy\\
=&amp;1-e^{-x^2/(2\sigma^2)}
\end{aligned}
\]</span></p>
<p>考虑分布函数的反函数 <span class="math display">\[
\begin{aligned}
F_X^{-1}(U)=\sqrt{-2\sigma^2ln(1-U)}
\end{aligned}
\]</span></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>u<span class="ot">&lt;-</span><span class="fu">runif</span>(n)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>y<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">20</span>,.<span class="dv">01</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="co">#par(mfrow=c(1,2))</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co">#sigma=2的情形，可以看出拟合较好</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>sig_1<span class="ot">&lt;-</span><span class="dv">2</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>x_1<span class="ot">&lt;-</span><span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>sig_1<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>u))</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x_1,<span class="at">probability =</span> T,<span class="at">main=</span><span class="fu">expression</span>(sigma<span class="sc">==</span><span class="dv">2</span>))</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="co">#添加理论密度曲线,图中为红线</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(y,y<span class="sc">/</span>sig_1<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>y<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>sig_1<span class="sc">^</span><span class="dv">2</span>)),<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">#sigma=5的情形，可以看出拟合较好</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>sig_2<span class="ot">&lt;-</span><span class="dv">5</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>x_2<span class="ot">&lt;-</span><span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>sig_2<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>u))</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x_2,<span class="at">probability =</span> T,<span class="at">main=</span><span class="fu">expression</span>(sigma<span class="sc">==</span><span class="dv">5</span>))</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co">#添加理论密度曲线,图中为红线</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(y,y<span class="sc">/</span>sig_2<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>y<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>sig_2<span class="sc">^</span><span class="dv">2</span>)),<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="题3.11" class="section level3">
<h3>题3.11</h3>
<p>Generate a random sample of size 1000 from a normal location mixture. The components of the mixture have N (0, 1) and N (3, 1) distributions with mixing probabilities <span class="math inline">\(p_1\)</span> and <span class="math inline">\(p_2=1-p_1\)</span>. Graph the histogram of the sample with density<br />
superimposed, for <span class="math inline">\(p_1\)</span> = 0.75. Repeat with diﬀerent values for <span class="math inline">\(p_1\)</span> and observe whether the empirical distribution of the mixture appears to be bimodal. Make a conjecture about the values of <span class="math inline">\(p_1\)</span> that produce bimodal mixtures.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>bif<span class="ot">&lt;-</span><span class="cf">function</span>(p)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co">#定义函数bif,输入p_1=p,输出对应混合分布直方图</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="fl">1e3</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>X1<span class="ot">&lt;-</span><span class="fu">rnorm</span>(n,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>X2<span class="ot">&lt;-</span><span class="fu">rnorm</span>(n,<span class="dv">3</span>,<span class="dv">1</span>)</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>p_1<span class="ot">&lt;-</span>p;p_2<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">-</span>p_1</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>r<span class="ot">&lt;-</span><span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),n,<span class="at">replace =</span> T,<span class="at">prob =</span> <span class="fu">c</span>(p_2,p_1))</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>Z<span class="ot">&lt;-</span>r<span class="sc">*</span>X1<span class="sc">+</span>(<span class="dv">1</span><span class="sc">-</span>r)<span class="sc">*</span>X2</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(Z,<span class="at">main=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co">#输出p_1=0.75时的混合分布直方图</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">bif</span>(<span class="fl">0.75</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="at">main=</span><span class="st">&quot;p=0.75&quot;</span>,<span class="at">outer =</span> T)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co">#输出p_1=0.1,...,1时的混合分布直方图</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bif</span>(<span class="fl">0.25</span><span class="sc">*</span>i)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="at">main=</span><span class="st">&quot;p=0.1,0.2,...,1.0&quot;</span>,<span class="at">outer =</span> T)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co">#可以看出双峰集中在0.4~0.6</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="co">#输出p_1=0.40,...,0.60时的混合分布直方图</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bif</span>(<span class="fl">0.4+0.05</span><span class="sc">*</span>i)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="at">main=</span><span class="st">&quot;p=0.40,0.42,...,0.60&quot;</span>,<span class="at">outer =</span> T)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co">#可以看出p_1取值在0.5附近时双峰较为明显</span></span></code></pre></div>
</div>
<div id="题3.20" class="section level3">
<h3>题3.20</h3>
<p>A compound Poisson process is a stochastic process{ <span class="math inline">\(X(t),t\geq 0\)</span> }that can be represented as the random sum <span class="math inline">\(X(t)=\sum_{i=1}^NY_i,t\geq0,\)</span>where {<span class="math inline">\(N(t),t\geq0\)</span>} is a Poisson process and <span class="math inline">\(Y_1,Y_2,\cdots\)</span> are iid and independent of {<span class="math inline">\(N(t),t\geq0\)</span>}. Write a program to simulate a compound Poisson(<span class="math inline">\(\lambda\)</span>)–Gamma process (Y has a Gamma distribution). Estimate the mean and the variance of <span class="math inline">\(X(10)\)</span> for several choices of the parameters and compare with the theoretical values. Hint: Show that <span class="math inline">\(E[X(t)]=\lambda tE[Y_1]\)</span>and <span class="math inline">\(Var(X(t))=\lambda tE[Y_1^2]\)</span>.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>poi_gamma<span class="ot">&lt;-</span><span class="cf">function</span>(n,t,lambda,shape,rate)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="do">##生成复合泊松分布,输入样本数n,随机过程时刻t,</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="do">##Poisson过程参数lambda,gamma分布参数shape和rate,</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="do">##输出样本的均值和方差以及理论均值和方差</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  <span class="co">#生成n个复合泊松过程的样本</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>  X<span class="ot">&lt;-</span><span class="fu">numeric</span>(n)</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n)</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>    <span class="co">#生成泊松过程N(t)</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>    Tn<span class="ot">&lt;-</span><span class="fu">rexp</span>(n,lambda)</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>    Sn<span class="ot">&lt;-</span><span class="fu">cumsum</span>(Tn)</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>    N<span class="ot">&lt;-</span><span class="fu">min</span>(<span class="fu">which</span>(Sn<span class="sc">&gt;</span>t))<span class="sc">-</span><span class="dv">1</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>    Y<span class="ot">&lt;-</span><span class="fu">rgamma</span>(N,<span class="at">shape=</span>shape,<span class="at">rate=</span>rate)</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>    X[i]<span class="ot">&lt;-</span><span class="fu">sum</span>(Y)</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>  <span class="co">#输出样本均值和方差</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot;样本均值:&quot;</span>, <span class="fu">round</span>(<span class="fu">mean</span>(X),<span class="dv">2</span>),<span class="st">&quot;  样本方差:&quot;</span>, <span class="fu">round</span>(<span class="fu">var</span>(X),<span class="dv">2</span>)))</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a> <span class="co">#print(c(mean(X),var(X)))</span></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a> <span class="co">#输出理论均值和方差</span></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot;理论均值:&quot;</span>, <span class="fu">round</span>(lambda<span class="sc">*</span>t<span class="sc">*</span>shape<span class="sc">/</span>rate,<span class="dv">2</span>),<span class="st">&quot;  理论方差:&quot;</span>,<span class="fu">round</span>(lambda<span class="sc">*</span>t<span class="sc">*</span>shape<span class="sc">*</span>(shape<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span>rate<span class="sc">^</span><span class="dv">2</span>,<span class="dv">2</span>)))</span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a> <span class="co">#print(c(lambda*t*shape/rate,lambda*t*shape*(shape+1)/rate^2))</span></span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot;shape =  &quot;</span>, <span class="dv">3</span>,<span class="st">&quot;  rate =  &quot;</span>, <span class="dv">5</span>))</span></code></pre></div>
<pre><code>## [1] &quot;shape =  3  rate =  5&quot;</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">poi_gamma</span>(<span class="dv">1000</span>,<span class="dv">10</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">5</span>)</span></code></pre></div>
<pre><code>## [1] &quot;样本均值:12.01  样本方差:9.3&quot;
## [1] &quot;理论均值:12  理论方差:9.6&quot;</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co">#模拟较好</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="co">#针对不同的shape和rate参数，</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">#更换不同的shape值和rate值,查看拟合情况</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot;shape =  &quot;</span>, i,<span class="st">&quot;  rate =  &quot;</span>, j))</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">poi_gamma</span>(<span class="dv">1000</span>,<span class="dv">10</span>,<span class="dv">2</span>,i,j)</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] &quot;shape =  1  rate =  1&quot;
## [1] &quot;样本均值:20.09  样本方差:39.02&quot;
## [1] &quot;理论均值:20  理论方差:40&quot;
## [1] &quot;shape =  1  rate =  2&quot;
## [1] &quot;样本均值:10  样本方差:10.62&quot;
## [1] &quot;理论均值:10  理论方差:10&quot;
## [1] &quot;shape =  1  rate =  3&quot;
## [1] &quot;样本均值:6.68  样本方差:4.34&quot;
## [1] &quot;理论均值:6.67  理论方差:4.44&quot;
## [1] &quot;shape =  2  rate =  1&quot;
## [1] &quot;样本均值:39.82  样本方差:125.21&quot;
## [1] &quot;理论均值:40  理论方差:120&quot;
## [1] &quot;shape =  2  rate =  2&quot;
## [1] &quot;样本均值:19.9  样本方差:31.06&quot;
## [1] &quot;理论均值:20  理论方差:30&quot;
## [1] &quot;shape =  2  rate =  3&quot;
## [1] &quot;样本均值:13.49  样本方差:13.98&quot;
## [1] &quot;理论均值:13.33  理论方差:13.33&quot;
## [1] &quot;shape =  3  rate =  1&quot;
## [1] &quot;样本均值:60.19  样本方差:247.59&quot;
## [1] &quot;理论均值:60  理论方差:240&quot;
## [1] &quot;shape =  3  rate =  2&quot;
## [1] &quot;样本均值:29.76  样本方差:57.08&quot;
## [1] &quot;理论均值:30  理论方差:60&quot;
## [1] &quot;shape =  3  rate =  3&quot;
## [1] &quot;样本均值:19.94  样本方差:26.1&quot;
## [1] &quot;理论均值:20  理论方差:26.67&quot;</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co">#拟合较好</span></span></code></pre></div>
</div>
</div>
<div id="hw2" class="section level2">
<h2>HW2</h2>
<div id="题5.4" class="section level3">
<h3>题5.4</h3>
<p>Write a function to compute a Monte Carlo estimate of the <span class="math inline">\(Beta(3, 3)\)</span> cdf, and use the function to estimate <span class="math inline">\(F(x)\)</span> for<span class="math inline">\(x = 0.1, 0.2, \cdots, 0.9.\)</span>Compare the estimates with the values returned by the pbeta function in R.</p>
<p>概率密度函数为: <span class="math display">\[
f(x;\alpha,\beta)=\frac{1}{B(\alpha,\beta)}x^{\alpha-1}(1-x)^{\beta-1}
\]</span></p>
<p>累计分布函数为: <span class="math display">\[
\begin{aligned}
F(x;\alpha,\beta)=&amp;\frac{1}{B(\alpha,\beta)}\int_0^xt^{\alpha-1}(1-t)^{\beta-1}dt\\
=&amp;\frac{x}{B(\alpha,\beta)}E[t^{\alpha-1}(1-t)^{\beta-1}],t\sim U(0,x)
\end{aligned}
\]</span></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>beta_mc<span class="ot">&lt;-</span><span class="cf">function</span>(<span class="at">m=</span><span class="fl">1e5</span>,x)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="do">###m为生成均匀分布样本数,默认取1e5</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="do">###x取值范围为0,1</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="do">###输出蒙特卡洛方法得到的B(x;3,3)</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(x<span class="sc">&lt;</span><span class="dv">0</span> <span class="sc">||</span> x<span class="sc">&gt;</span><span class="dv">1</span>)</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">&quot;x is out of range&quot;</span>)</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>  t<span class="ot">&lt;-</span><span class="fu">runif</span>(m,<span class="at">min=</span><span class="dv">0</span>,<span class="at">max=</span>x)</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>  theta.hat<span class="ot">&lt;-</span>x<span class="sc">*</span><span class="fu">mean</span>(t<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>t)<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">beta</span>(<span class="dv">3</span>,<span class="dv">3</span>)</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(theta.hat)</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="fl">0.1</span>,<span class="fl">0.9</span>,<span class="fl">0.1</span>)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="fu">length</span>(x)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>theta.hat<span class="ot">&lt;-</span>theta<span class="ot">&lt;-</span><span class="fu">numeric</span>(n)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n)</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>  theta.hat[i]<span class="ot">=</span><span class="fu">beta_mc</span>(<span class="at">x=</span>x[i])</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>  theta[i]<span class="ot">=</span><span class="fu">pbeta</span>(<span class="at">q=</span>x[i],<span class="at">shape1 =</span> <span class="dv">3</span>,<span class="at">shape2 =</span> <span class="dv">3</span>)</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot;x=&quot;</span>,x[i],<span class="st">&quot;时,生成值:&quot;</span>, <span class="fu">round</span>(theta.hat[i],<span class="dv">3</span>),<span class="st">&quot;,理论值:&quot;</span>, <span class="fu">round</span>(theta[i],<span class="dv">3</span>)))</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] &quot;x=0.1时,生成值:0.009,理论值:0.009&quot;
## [1] &quot;x=0.2时,生成值:0.058,理论值:0.058&quot;
## [1] &quot;x=0.3时,生成值:0.163,理论值:0.163&quot;
## [1] &quot;x=0.4时,生成值:0.317,理论值:0.317&quot;
## [1] &quot;x=0.5时,生成值:0.499,理论值:0.5&quot;
## [1] &quot;x=0.6时,生成值:0.683,理论值:0.683&quot;
## [1] &quot;x=0.7时,生成值:0.837,理论值:0.837&quot;
## [1] &quot;x=0.8时,生成值:0.942,理论值:0.942&quot;
## [1] &quot;x=0.9时,生成值:0.995,理论值:0.991&quot;</code></pre>
</div>
<div id="题5.9" class="section level3">
<h3>题5.9</h3>
<p>The Rayleigh density [156, (18.76)] is <span class="math display">\[
f(x)=\frac{x}{\sigma^2}e^{-x^2/(2\sigma^2)},\qquad x\geq0,\sigma&gt;0.
\]</span> Implement a function to generate samples from a <span class="math inline">\(Rayleigh(\sigma)\)</span> distribution, using antithetic variables. What is the percent reduction in variance of <span class="math inline">\(\frac{X+X&#39;}{2}\)</span> compared with <span class="math inline">\(\frac{X_1+X_2}{2}\)</span> for independent<span class="math inline">\(X_1,X_2\)</span>?</p>
<p>分布函数</p>
<p><span class="math display">\[
\begin{aligned}
F_X(x)=&amp;\int_{0}^xf(y)dy\\
=&amp;\int_{0}^x\frac{y}{\sigma^2}e^{-y^2/(2\sigma^2)}dy\\
=&amp;1-e^{-x^2/(2\sigma^2)}
\end{aligned}
\]</span></p>
<p>对偶变量估计量为: <span class="math display">\[
\hat{\theta}&#39;=\frac{1}{m}\sum_{j=1}^{m/2}(x\frac{U_j}{\sigma^2}e^{-U_j^2/(2\sigma^2)}+x\frac{x-U_j}{\sigma^2}e^{-(x-U_j)^2/(2\sigma^2)}),U_j\sim U(0,x).
\]</span></p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>Rayleigh<span class="ot">&lt;-</span><span class="cf">function</span>(sigma, <span class="at">n=</span><span class="dv">10000</span>, <span class="at">antithetic=</span><span class="cn">TRUE</span>)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a> u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)<span class="co">#生成n/2个均匀随机数</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="sc">!</span>antithetic) v <span class="ot">&lt;-</span> <span class="fu">runif</span>(n) <span class="cf">else</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>    v <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span>u<span class="co">#若应用对偶变量，则令后一半均匀随机数v为1-u，否则v为n个均匀随机数且与u独立</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  X1 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>sigma<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(u))<span class="co">#利用u生成一组Rayleigh分布随机数X1</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>  X2 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>sigma<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(v))<span class="co">#利用v生成一组Rayleigh分布随机数X2</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> (X1<span class="sc">+</span>X2)<span class="sc">/</span><span class="dv">2</span><span class="co">#取两组样本均值得到最终估计</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>sigma<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">:</span><span class="dv">5</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>var_reduction <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">ncol =</span> <span class="fu">length</span>(sigma))<span class="co">#存储结果矩阵</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(sigma)) {</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  simple<span class="ot">&lt;-</span><span class="fu">Rayleigh</span>(<span class="at">sigma =</span> sigma[i],<span class="at">antithetic=</span><span class="cn">FALSE</span>)</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  antithetic<span class="ot">&lt;-</span><span class="fu">Rayleigh</span>(<span class="at">sigma =</span> sigma[i])</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>  var_reduction[<span class="dv">1</span>, i] <span class="ot">&lt;-</span> (<span class="fu">var</span>(simple)<span class="sc">-</span><span class="fu">var</span>(antithetic))<span class="sc">/</span><span class="fu">var</span>(simple)</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a><span class="fu">dimnames</span>(var_reduction)[[<span class="dv">2</span>]] <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;sigma =&quot;</span>, sigma)<span class="co">#重命名各列</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(var_reduction, <span class="at">caption =</span> <span class="st">&quot;表2.1：对偶变量法生成Rayleigh随机数相比简单方法生成Rayleigh随机数方差减少的比例&quot;</span>)<span class="co">#绘制结果表格</span></span></code></pre></div>
<table>
<caption>表2.1：对偶变量法生成Rayleigh随机数相比简单方法生成Rayleigh随机数方差减少的比例</caption>
<thead>
<tr class="header">
<th align="right">sigma = 1</th>
<th align="right">sigma = 2</th>
<th align="right">sigma = 3</th>
<th align="right">sigma = 4</th>
<th align="right">sigma = 5</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.9494173</td>
<td align="right">0.9420766</td>
<td align="right">0.9475476</td>
<td align="right">0.9506812</td>
<td align="right">0.9445254</td>
</tr>
</tbody>
</table>
</div>
<div id="题5.13" class="section level3">
<h3>题5.13</h3>
<p>Find two importance functions<span class="math inline">\(f_1\)</span> and <span class="math inline">\(f_2\)</span> that are supported on <span class="math inline">\((1,+\infty)\)</span> and are ‘close’ to <span class="math display">\[
g(x)=\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2},\qquad x&gt;1
\]</span> Which of your two importance functions should produce the smaller variance in estimating <span class="math display">\[
\int_1^{+\infty}\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2}dx
\]</span> by importance sampling? Explain.</p>
<p>选取函数<span class="math inline">\(f_1(x),f_2(x)\)</span>如下,<span class="math inline">\(f_1\)</span>理应产生更小方差，因为与<span class="math inline">\(g(x)\)</span>更接近</p>
<p><span class="math display">\[
\begin{aligned}
&amp;f_1(x)=1\\
&amp;f_2(x)=\frac{e^{-x}}{1-e^{-1}}
\end{aligned}
\]</span></p>
<p><span class="math display">\[
\begin{aligned}
&amp;\because\int_0^{+\infty}\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2}dx=\frac{1}{2} \\
&amp;\therefore \int_1^{+\infty}\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2}dx=\frac{1}{2}-\int_0^{1}\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2}dx
\end{aligned}
\]</span></p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>g<span class="ot">&lt;-</span><span class="cf">function</span>(x) <span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>f1<span class="ot">&lt;-</span><span class="cf">function</span>(x) <span class="fu">rep</span>(<span class="dv">1</span>,<span class="fu">length</span>(x))</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>f2<span class="ot">&lt;-</span><span class="cf">function</span>(x) <span class="fu">exp</span>(<span class="sc">-</span>x)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>gs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">expression</span>(<span class="fu">g</span>(x)<span class="sc">==</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>e<span class="sc">^</span>{<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>}<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)),</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>            <span class="fu">expression</span>(f[<span class="dv">1</span>](x)<span class="sc">==</span><span class="dv">1</span>),</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>            <span class="fu">expression</span>(f[<span class="dv">2</span>](x)<span class="sc">==</span>e<span class="sc">^</span>{<span class="sc">-</span>x}<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>e<span class="sc">^</span>{<span class="sc">-</span><span class="dv">1</span>})))</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a><span class="co">#计算(0,1)内理论积分值</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>I_g<span class="ot">&lt;-</span><span class="fu">integrate</span>(g,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>I_g</span></code></pre></div>
<pre><code>## 0.09937402 with absolute error &lt; 1.1e-15</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co">#计算理论积分值</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">/</span><span class="dv">2</span><span class="sc">-</span>I_g<span class="sc">$</span>value   </span></code></pre></div>
<pre><code>## [1] 0.400626</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, .<span class="dv">01</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x,<span class="fu">g</span>(x),<span class="at">col=</span><span class="dv">1</span>,<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">3</span>),<span class="at">lty=</span><span class="dv">1</span>,<span class="at">type =</span> <span class="st">&quot;l&quot;</span>)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x,<span class="fu">f1</span>(x),<span class="at">col=</span><span class="dv">2</span>,<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x,<span class="fu">f2</span>(x),<span class="at">col=</span><span class="dv">3</span>,<span class="at">lty=</span><span class="dv">3</span>)</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="at">legend =</span> gs,</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">lty =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">inset =</span> <span class="fl">0.02</span>,<span class="at">col=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="题5.14" class="section level3">
<h3>题5.14</h3>
<p>Obtain a Monte Carlo estimate of <span class="math display">\[
\int_1^{+\infty}\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2}dx
\]</span></p>
<p>by importance sampling.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  est <span class="ot">&lt;-</span> sd <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">2</span>)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a> x <span class="ot">&lt;-</span> <span class="fu">runif</span>(m) <span class="co">#using f1</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>  fg <span class="ot">&lt;-</span> <span class="fu">g</span>(x)</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>  est[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(fg)</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>  sd[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">sd</span>(fg)</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(m) <span class="co">#f2, inverse transform method</span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="sc">-</span> <span class="fu">log</span>(<span class="dv">1</span> <span class="sc">-</span> u <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>)))</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>  fg <span class="ot">&lt;-</span> <span class="fu">g</span>(x) <span class="sc">/</span> (<span class="fu">exp</span>(<span class="sc">-</span>x) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>)))</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>  est[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(fg)</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>  sd[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">sd</span>(fg)</span></code></pre></div>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="at">est=</span><span class="fu">round</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span><span class="sc">-</span>est,<span class="dv">3</span>), <span class="at">sd=</span><span class="fu">round</span>(sd,<span class="dv">3</span>))</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(res)</span></code></pre></div>
<pre><code>##      [,1]  [,2]
## est 0.400 0.400
## sd  0.079 0.113</code></pre>
<p>可以看出,<span class="math inline">\(f_1(x)\)</span>的方差更小</p>
</div>
</div>
<div id="hw3" class="section level2">
<h2>HW3</h2>
<div id="题6.5" class="section level3">
<h3>题6.5</h3>
<p>Suppose a 95% symmetric t-interval is applied to estimate a mean, but the sample data are non-normal. Then the probability that the confidence interval covers the mean is not necessarily equal to 0.95. Use a Monte Carlo experiment to estimate the coverage probability of the t-interval for random samples of <span class="math inline">\(\chi^2(2)\)</span> data with sample size <span class="math inline">\(n = 20\)</span>. Compare your t-interval results with the simulation results in Example 6.4. (The t-interval should be more robust to departures from normality than the interval for variance.)</p>
<p>假设理论上样本<span class="math inline">\(X\sim N(2,\sigma^2),\sigma^2=4\)</span></p>
<p><span class="math display">\[\frac{\bar{x}-\mu}{S_n/\sqrt{n}}\sim t_{n-1}\]</span></p>
<p>置信区间为 <span class="math display">\[
[\mu-t_{n-1}(1-\alpha/2)S_n/\sqrt{n-1},\mu+t_{n-1}(1-\alpha/2)S_n/\sqrt{n}]
\]</span> 而实际生成的样本为<span class="math inline">\(X\sim \chi^2(2),E(X)=2,Var(X)=4\)</span></p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">13</span>)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">20</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>alpha<span class="ot">&lt;-</span><span class="fl">0.05</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="fl">1e4</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>p<span class="ot">&lt;-</span><span class="fu">numeric</span>(m)</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a> x<span class="ot">&lt;-</span><span class="fu">rchisq</span>(n,<span class="dv">2</span>)</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">abs</span>(<span class="fu">mean</span>(x)<span class="sc">-</span><span class="dv">2</span>)<span class="sc">&lt;=</span><span class="fu">sd</span>(x)<span class="sc">/</span><span class="fu">sqrt</span>(n)<span class="sc">*</span><span class="fu">qt</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>,<span class="at">df=</span>n<span class="dv">-1</span>)) p[i]<span class="ot">=</span><span class="dv">1</span> </span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(p)</span></code></pre></div>
<pre><code>## [1] 0.916</code></pre>
<p>使用Example 6.4中的模拟</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">20</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>alpha<span class="ot">&lt;-</span><span class="fl">0.05</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="fl">1e4</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>UCL<span class="ot">&lt;-</span><span class="fu">numeric</span>(m)</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a><span class="co">#x&lt;-rchisq(n,2)</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a> x<span class="ot">&lt;-</span><span class="fu">rchisq</span>(n,<span class="dv">2</span>)</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>UCL[i]<span class="ot">&lt;-</span>(n<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">var</span>(x)<span class="sc">/</span><span class="fu">qchisq</span>(alpha,<span class="at">df=</span>n<span class="dv">-1</span>)</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>((UCL<span class="sc">&gt;</span><span class="dv">4</span>))</span></code></pre></div>
<pre><code>## [1] 0.7881</code></pre>
<p>对比可得，t区间更加稳健</p>
</div>
<div id="题6.a" class="section level3">
<h3>题6.A</h3>
<p>Use Monte Carlo simulation to investigate whether the empirical Type I error rate of the t-test is approximately equal to the nominal significance level <span class="math inline">\(\alpha\)</span>, when the sampled population is non-normal. The t-test is robust to mild departures from normality. Discuss the simulation results for the cases where the sampled population is (i)<span class="math inline">\(\chi^2(1)\)</span>, (ii) Uniform(0,2), and (iii) Exponential(rate=1). In each case, test <span class="math inline">\(H_0:\mu=\mu_0\)</span>vs<span class="math inline">\(H_a:\mu\neq\mu_0\)</span>, where<span class="math inline">\(\mu_0\)</span> is the mean of<span class="math inline">\(\chi^2(1)\)</span>, Uniform(0,2), and Exponential(1), respectively.</p>
<ol style="list-style-type: lower-roman">
<li></li>
</ol>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">100</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="fl">1e4</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>p.val1<span class="ot">&lt;-</span>p.val2<span class="ot">&lt;-</span>p.val3<span class="ot">&lt;-</span><span class="fu">numeric</span>(m)</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>alpha<span class="ot">&lt;-</span>.<span class="dv">05</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>mu<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m)</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>p.val1[i]<span class="ot">&lt;-</span><span class="fu">t.test</span>(<span class="fu">rchisq</span>(n,<span class="at">df=</span><span class="dv">1</span>),<span class="at">mu=</span>mu,<span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span>)<span class="sc">$</span>p.value</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>p.val2[i]<span class="ot">&lt;-</span><span class="fu">t.test</span>(<span class="fu">runif</span>(n,<span class="at">min=</span><span class="dv">0</span>,<span class="at">max=</span><span class="dv">2</span>),<span class="at">mu=</span>mu,<span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span>)<span class="sc">$</span>p.value</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>p.val3[i]<span class="ot">&lt;-</span><span class="fu">t.test</span>(<span class="fu">rexp</span>(n),<span class="at">mu=</span>mu,<span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span>)<span class="sc">$</span>p.value</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a><span class="do">##可以看出一型错误率都较小，接近0.05，说明t分布足够稳健</span></span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(<span class="fu">c</span>(<span class="fu">mean</span>(p.val1<span class="sc">&lt;=</span>alpha),</span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(p.val2<span class="sc">&lt;=</span>alpha),</span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(p.val3<span class="sc">&lt;=</span>alpha)),<span class="dv">3</span>))</span></code></pre></div>
<pre><code>## [1] 0.068 0.049 0.062</code></pre>
</div>
<div id="exercise" class="section level3">
<h3>EXERCISE</h3>
<p>If we obtain the powers for two methods under a particular simulation setting with 10,000 experiments: say, 0.651 for one method and 0.676 for another method. We want to know if the powers are different at 0.05 level.</p>
<p>(1)What is the corresponding hypothesis test problem?</p>
<p>(2)What test should we use? Z-test, two-sample t-test, paired-t test or McNemar test? Why?</p>
<p>(3)Please provide the least necessary information for hypothesis testing</p>
<ol style="list-style-type: decimal">
<li></li>
</ol>
<p><span class="math display">\[
H_0:\pi(\theta_1)=\pi&#39;(\theta_1),\theta\sim \Theta_1,\leftrightarrow H_a:\pi(\theta_1)\neq\pi&#39;(\theta_1),\theta\sim \Theta_1
\]</span></p>
<p>(2)McNemar test. Because it is equivalent to test whether the acceptance rates of the two methods are the same. Also, a contingency table can be naturally constructed as in 3.</p>
<ol start="3" style="list-style-type: decimal">
<li></li>
</ol>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>mat <span class="ot">&lt;-</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">6510</span>, <span class="dv">3490</span>, <span class="dv">10000</span>, <span class="dv">6760</span>, <span class="dv">3240</span>, <span class="dv">10000</span>, <span class="dv">13270</span>, <span class="dv">6730</span>, <span class="dv">20000</span>), <span class="dv">3</span>, <span class="dv">3</span>,</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">dimnames =</span> <span class="fu">list</span>(</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>           <span class="fu">c</span>(<span class="st">&quot;Rejected&quot;</span>, <span class="st">&quot;Accepted&quot;</span>, <span class="st">&quot;total&quot;</span>),</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>           <span class="fu">c</span>(<span class="st">&quot;method A&quot;</span>, <span class="st">&quot;method B&quot;</span>, <span class="st">&quot;total&quot;</span>)</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>         ))</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>mat</span></code></pre></div>
<pre><code>##          method A method B total
## Rejected     6510     6760 13270
## Accepted     3490     3240  6730
## total       10000    10000 20000</code></pre>
<p>The test statistic: <span class="math display">\[\chi^2 = \sum_{i,j=1}^2 \frac{(n_{ij}-n_{i+} n_{+j}/n)^2}{n_{i+}n_{+j}/n} \rightarrow \chi^2_1.\]</span> Note that <span class="math inline">\(\chi^2 = 13.9966\)</span> and the p-value is <span class="math inline">\(P(\chi^2_1 &gt; \chi^2) = 0.0001831415 &lt; 0.05\)</span>. Therefore, we reject the null hypothesis <span class="math inline">\(H_0\)</span>, that is, the powers are different at <span class="math inline">\(0.05\)</span> level.</p>
</div>
</div>
<div id="hw4" class="section level2">
<h2>HW4</h2>
<div id="题6.c" class="section level3">
<h3>题6.C</h3>
<p>Repeat Examples 6.8 and 6.10 for Mardia’s multivariate skewness test. Mardia [187] proposed tests of multivariate normality based on multivariate generalizations of skewness and kurtosis. If X and Y are iid, the multivariate population skewness <span class="math inline">\(\beta_{1,d}\)</span> is defined by Mardia as <span class="math display">\[
\beta_{1,d}=E[(X-\mu)^T\Sigma^{-1}(Y-\mu)]^3.
\]</span></p>
<p>Under normality,<span class="math inline">\(\beta_{1,d}.\)</span> The multivariate skewness statistic is <span class="math display">\[
b_{1,d}=\frac{1}{n^2}\sum_{i,j=1}^n((X_i-\bar{x})^T\hat{\Sigma}^{-1}(X_j-\bar{X}))^3,
\]</span> where <span class="math inline">\(\hat{\Sigma}\)</span> is the maximum likelihood estimator of covariance. Large values of ˆ <span class="math inline">\(b_{1,d}\)</span> are significant. The asymptotic distribution of <span class="math inline">\(nb_{1,d}/6\)</span> is chisquared with <span class="math inline">\(d(d + 1)(d + 2)/6\)</span> degrees of freedom.</p>
<div id="example-6.8" class="section level4">
<h4>Example 6.8</h4>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">500</span>) <span class="co">#sample sizes</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>cv <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(.<span class="dv">975</span>, <span class="dv">0</span>, <span class="fu">sqrt</span>(<span class="dv">6</span><span class="sc">/</span>n)) <span class="co">#crit. values for each n</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>sk <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="co">#computes the sample skewness coeff.</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>xbar <span class="ot">&lt;-</span> <span class="fu">mean</span>(x)</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>m3 <span class="ot">&lt;-</span> <span class="fu">mean</span>((x <span class="sc">-</span> xbar)<span class="sc">^</span><span class="dv">3</span>)</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">mean</span>((x <span class="sc">-</span> xbar)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>( m3 <span class="sc">/</span> m2<span class="sc">^</span><span class="fl">1.5</span> )</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="co">#n is a vector of sample sizes</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="co">#we are doing length(n) different simulations</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>p.reject <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(n)) <span class="co">#to store sim. results</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">10000</span> <span class="co">#num. repl. each sim.</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(n)) {</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>sktests <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m) <span class="co">#test decisions</span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n[i])</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a><span class="co">#test decision is 1 (reject) or 0</span></span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>sktests[j] <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="fu">abs</span>(<span class="fu">sk</span>(x)) <span class="sc">&gt;=</span> cv[i] )</span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>p.reject[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(sktests) <span class="co">#proportion rejected</span></span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>p.reject</span></code></pre></div>
<pre><code>## [1] 0.0132 0.0299 0.0342 0.0377 0.0423 0.0501</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>cv <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(.<span class="dv">975</span>, <span class="dv">0</span>, <span class="fu">sqrt</span>(<span class="dv">6</span><span class="sc">*</span>(n<span class="dv">-2</span>) <span class="sc">/</span> ((n<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span>(n<span class="sc">+</span><span class="dv">3</span>))))</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(cv, <span class="dv">4</span>)</span></code></pre></div>
<pre><code>## [1] 1.1355 0.9268 0.7943 0.6398 0.4660 0.2134</code></pre>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co">#n is a vector of sample sizes</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="co">#we are doing length(n) different simulations</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>p.reject <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(n)) <span class="co">#to store sim. results</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">2500</span> <span class="co">#num. repl. each sim.</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(n)) {</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>sktests <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m) <span class="co">#test decisions</span></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n[i])</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a><span class="co">#test decision is 1 (reject) or 0</span></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>sktests[j] <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="fu">abs</span>(<span class="fu">sk</span>(x)) <span class="sc">&gt;=</span> cv[i] )</span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>p.reject[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(sktests) <span class="co">#proportion rejected</span></span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>p.reject</span></code></pre></div>
<pre><code>## [1] 0.0472 0.0564 0.0504 0.0544 0.0516 0.0524</code></pre>
</div>
<div id="example-6.10" class="section level4">
<h4>Example 6.10</h4>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> .<span class="dv">1</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">2500</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>epsilon <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">seq</span>(<span class="dv">0</span>, .<span class="dv">15</span>, .<span class="dv">01</span>), <span class="fu">seq</span>(.<span class="dv">15</span>, <span class="dv">1</span>, .<span class="dv">05</span>))</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">length</span>(epsilon)</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>pwr <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a><span class="co">#critical value for the skewness test</span></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>cv <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="fu">sqrt</span>(<span class="dv">6</span><span class="sc">*</span>(n<span class="dv">-2</span>) <span class="sc">/</span> ((n<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span>(n<span class="sc">+</span><span class="dv">3</span>))))</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) { <span class="co">#for each epsilon</span></span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> epsilon[j]</span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>sktests <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) { <span class="co">#for each replicate</span></span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">10</span>), <span class="at">replace =</span> <span class="cn">TRUE</span>,</span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a><span class="at">size =</span> n, <span class="at">prob =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">-</span>e, e))</span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, sigma)</span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a>sktests[i] <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="fu">abs</span>(<span class="fu">sk</span>(x)) <span class="sc">&gt;=</span> cv)</span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a>pwr[j] <span class="ot">&lt;-</span> <span class="fu">mean</span>(sktests)</span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb49-20"><a href="#cb49-20" aria-hidden="true" tabindex="-1"></a><span class="co">#plot power vs epsilon</span></span>
<span id="cb49-21"><a href="#cb49-21" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(epsilon, pwr, <span class="at">type =</span> <span class="st">&quot;b&quot;</span>,</span>
<span id="cb49-22"><a href="#cb49-22" aria-hidden="true" tabindex="-1"></a><span class="at">xlab =</span> <span class="fu">bquote</span>(epsilon), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb49-23"><a href="#cb49-23" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> .<span class="dv">1</span>, <span class="at">lty =</span> <span class="dv">3</span>)</span>
<span id="cb49-24"><a href="#cb49-24" aria-hidden="true" tabindex="-1"></a>se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(pwr <span class="sc">*</span> (<span class="dv">1</span><span class="sc">-</span>pwr) <span class="sc">/</span> m) <span class="co">#add standard errors</span></span>
<span id="cb49-25"><a href="#cb49-25" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(epsilon, pwr<span class="sc">+</span>se, <span class="at">lty =</span> <span class="dv">3</span>)</span>
<span id="cb49-26"><a href="#cb49-26" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(epsilon, pwr<span class="sc">-</span>se, <span class="at">lty =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="c" class="section level4">
<h4>6.c</h4>
<p>极大似然估计为 <span class="math display">\[
\hat{\Sigma}=\frac{1}{n}\sum_{i=1}^n(x^{(i)}-\bar{x})(x^{(i)}-\bar{x})^T
\]</span> 其中<span class="math inline">\(x^{(i)}\)</span>为第i个样本</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>nn <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>,<span class="dv">50</span>)          <span class="co"># 样本容量</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span>                 <span class="co"># 显著性水平</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="dv">2</span>                        <span class="co"># 随机变量的维数</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>b0 <span class="ot">&lt;-</span> <span class="fu">qchisq</span>(<span class="dv">1</span><span class="sc">-</span>alpha,<span class="at">df=</span>d<span class="sc">*</span>(d<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span>(d<span class="sc">+</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">6</span>)<span class="sc">*</span><span class="dv">6</span><span class="sc">/</span>nn  <span class="co"># 每种样本容量临界值向量</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 计算多元样本偏度统计量</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>mul.sk <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(x) <span class="co"># 样本个数</span></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>  xbar <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(x) </span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>  sigma.hat <span class="ot">&lt;-</span> (n<span class="dv">-1</span>)<span class="sc">/</span>n<span class="sc">*</span><span class="fu">cov</span>(x) <span class="co"># MLE估计</span></span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>  b <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(x)){</span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(x)){</span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a>      b <span class="ot">&lt;-</span> b<span class="sc">+</span>((x[i,]<span class="sc">-</span>xbar)<span class="sc">%*%</span><span class="fu">solve</span>(sigma.hat)<span class="sc">%*%</span>(x[j,]<span class="sc">-</span>xbar))<span class="sc">^</span><span class="dv">3</span></span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(b<span class="sc">/</span>(n<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb50-19"><a href="#cb50-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb50-20"><a href="#cb50-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-21"><a href="#cb50-21" aria-hidden="true" tabindex="-1"></a><span class="co"># 计算第一类错误的经验估计</span></span>
<span id="cb50-22"><a href="#cb50-22" aria-hidden="true" tabindex="-1"></a><span class="do">##library(mvtnorm)</span></span>
<span id="cb50-23"><a href="#cb50-23" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">200</span>)</span>
<span id="cb50-24"><a href="#cb50-24" aria-hidden="true" tabindex="-1"></a>p.reject <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">mode =</span> <span class="st">&quot;numeric&quot;</span>,<span class="at">length =</span> <span class="fu">length</span>(nn)) <span class="co"># 保存模拟结果</span></span>
<span id="cb50-25"><a href="#cb50-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-26"><a href="#cb50-26" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb50-27"><a href="#cb50-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-28"><a href="#cb50-28" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(nn)){</span>
<span id="cb50-29"><a href="#cb50-29" aria-hidden="true" tabindex="-1"></a>  mul.sktests <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">mode =</span> <span class="st">&quot;numeric&quot;</span>,<span class="at">length =</span> m)</span>
<span id="cb50-30"><a href="#cb50-30" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb50-31"><a href="#cb50-31" aria-hidden="true" tabindex="-1"></a>    data <span class="ot">&lt;-</span> mvtnorm<span class="sc">::</span><span class="fu">rmvnorm</span>(nn[i],<span class="at">mean =</span> <span class="fu">rep</span>(<span class="dv">0</span>,d))</span>
<span id="cb50-32"><a href="#cb50-32" aria-hidden="true" tabindex="-1"></a>    mul.sktests[j] <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="fu">mul.sk</span>(data)<span class="sc">&gt;</span>b0[i])</span>
<span id="cb50-33"><a href="#cb50-33" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb50-34"><a href="#cb50-34" aria-hidden="true" tabindex="-1"></a>  p.reject[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(mul.sktests)</span>
<span id="cb50-35"><a href="#cb50-35" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb50-36"><a href="#cb50-36" aria-hidden="true" tabindex="-1"></a>p.reject</span></code></pre></div>
<pre><code>## [1] 0.00 0.03 0.04 0.03</code></pre>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>summ <span class="ot">&lt;-</span> <span class="fu">rbind</span>(nn,p.reject)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(summ) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;n&quot;</span>,<span class="st">&quot;estimate&quot;</span>)</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(summ)</span></code></pre></div>
<table>
<tbody>
<tr class="odd">
<td align="left">n</td>
<td align="right">10</td>
<td align="right">20.00</td>
<td align="right">30.00</td>
<td align="right">50.00</td>
</tr>
<tr class="even">
<td align="left">estimate</td>
<td align="right">0</td>
<td align="right">0.03</td>
<td align="right">0.04</td>
<td align="right">0.03</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="hw5" class="section level2">
<h2>HW5</h2>
<div id="exercise-7.7" class="section level3">
<h3>Exercise 7.7</h3>
<p>Refer to Exercise 7.6. Efron and Tibshirani discuss the following example [84, Ch. 7]. The five-dimensional scores data have a <span class="math inline">\(5\times 5\)</span> covariance matrix <span class="math inline">\(\Sigma\)</span>, with positive eigenvalues <span class="math inline">\(\lambda_1&gt;\cdots \lambda_5\)</span> In principal components analysis, <span class="math display">\[
\theta=\frac{\lambda_1}{\sum_{i=1}^5\lambda_i}
\]</span> measures the proportion of variance explained by the first principal component. Let<span class="math inline">\(\hat{\lambda}_1&gt;\cdots \hat{\lambda}_5\)</span> be the eigenvalues of <span class="math inline">\(\hat{\Sigma}\)</span>, where <span class="math inline">\(\hat{\Sigma}\)</span> is the MLE of <span class="math inline">\(\Sigma\)</span> Compute the sample estimate <span class="math display">\[
\hat{\theta}=\frac{\hat{\lambda}_1}{\sum_{i=1}^5\hat{\lambda}_i}
\]</span></p>
<p>of <span class="math inline">\(\theta\)</span>. Use bootstrap to estimate the bias and standard error of <span class="math inline">\(\hat{\theta}\)</span>.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co">#library(boot)</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="co">#library(bootstrap)</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="co">#library(MASS)</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>b.theta <span class="ot">&lt;-</span> <span class="cf">function</span>(x,i) {</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>d<span class="ot">&lt;-</span>x[i,]</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>sigma_hat<span class="ot">&lt;-</span><span class="fu">cov</span>(d)<span class="sc">/</span><span class="fu">nrow</span>(x)<span class="sc">*</span>(<span class="fu">nrow</span>(x)<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>value<span class="ot">&lt;-</span><span class="fu">eigen</span>(sigma_hat)<span class="sc">$</span>values[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(<span class="fu">eigen</span>(sigma_hat)<span class="sc">$</span>values)</span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(value)</span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a><span class="do">## theta hat为obj$t0</span></span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a>obj <span class="ot">&lt;-</span> boot<span class="sc">::</span><span class="fu">boot</span>(<span class="at">data=</span>bootstrap<span class="sc">::</span>scor,<span class="at">statistic=</span>b.theta,<span class="at">R=</span><span class="dv">2000</span>)</span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(<span class="at">original=</span>obj<span class="sc">$</span>t0,<span class="at">bias=</span><span class="fu">mean</span>(obj<span class="sc">$</span>t)<span class="sc">-</span>obj<span class="sc">$</span>t0,</span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a>            <span class="at">se=</span><span class="fu">sd</span>(obj<span class="sc">$</span>t)),<span class="dv">3</span>)</span></code></pre></div>
<pre><code>## original     bias       se 
##    0.619    0.002    0.047</code></pre>
</div>
<div id="exercise-7.8" class="section level3">
<h3>Exercise 7.8</h3>
<p>Refer to Exercise 7.7. Obtain the jackknife estimates of bias and standard error of <span class="math inline">\(\hat{\theta}\)</span></p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="fu">nrow</span>(bootstrap<span class="sc">::</span>scor)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>theta.hat<span class="ot">&lt;-</span><span class="fu">b.theta</span>(bootstrap<span class="sc">::</span>scor,<span class="dv">1</span><span class="sc">:</span>n)</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>theta.jack<span class="ot">&lt;-</span><span class="fu">numeric</span>(n)</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n)</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>  theta.jack[i]<span class="ot">&lt;-</span><span class="fu">b.theta</span>(bootstrap<span class="sc">::</span>scor,(<span class="dv">1</span><span class="sc">:</span>n)[<span class="sc">-</span>i])</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>bias.jack<span class="ot">&lt;-</span>(n<span class="dv">-1</span>)<span class="sc">*</span>(<span class="fu">mean</span>(theta.jack)<span class="sc">-</span>theta.hat)</span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>se.jack<span class="ot">&lt;-</span><span class="fu">sqrt</span>((n<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">mean</span>((theta.jack<span class="sc">-</span>theta.hat)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(<span class="at">original=</span>theta.hat,<span class="at">bias.jack=</span>bias.jack,</span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">se.jack=</span>se.jack),<span class="dv">3</span>)</span></code></pre></div>
<pre><code>##  original bias.jack   se.jack 
##     0.619     0.001     0.050</code></pre>
</div>
<div id="exercise-7.9" class="section level3">
<h3>Exercise 7.9</h3>
<p>Refer to Exercise 7.7. Compute 95% percentile and BCa confidence intervals for <span class="math inline">\(\hat{\theta}\)</span>.</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co">#percentile confidence intervals</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>alpha<span class="ot">&lt;-</span><span class="fu">c</span>(.<span class="dv">025</span>,.<span class="dv">975</span>)</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(obj<span class="sc">$</span>t,alpha,<span class="at">type=</span><span class="dv">6</span>)</span></code></pre></div>
<pre><code>##      2.5%     97.5% 
## 0.5223778 0.7075889</code></pre>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co">#BCa confidence intervals</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>zalpha<span class="ot">&lt;-</span><span class="fu">qnorm</span>(alpha)</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>z0<span class="ot">&lt;-</span><span class="fu">qnorm</span>(<span class="fu">sum</span>(obj<span class="sc">$</span>t<span class="sc">&lt;</span>theta.hat)<span class="sc">/</span><span class="fu">length</span>(obj<span class="sc">$</span>t))</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>L<span class="ot">&lt;-</span><span class="fu">mean</span>(theta.jack)<span class="sc">-</span>theta.jack</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>a<span class="ot">&lt;-</span><span class="fu">sum</span>(L<span class="sc">^</span><span class="dv">3</span>)<span class="sc">/</span>(<span class="dv">6</span><span class="sc">*</span><span class="fu">sum</span>(L<span class="sc">^</span><span class="dv">2</span>)<span class="sc">^</span><span class="fl">1.5</span>)</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>adj.alpha<span class="ot">&lt;-</span><span class="fu">pnorm</span>(z0<span class="sc">+</span>(z0<span class="sc">+</span>zalpha)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>a<span class="sc">*</span>(z0<span class="sc">+</span>zalpha)))</span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(obj<span class="sc">$</span>t,adj.alpha,<span class="at">type=</span><span class="dv">6</span>)</span></code></pre></div>
<pre><code>## 2.378262% 97.36266% 
## 0.5221414 0.7067675</code></pre>
</div>
<div id="project-7.b" class="section level3">
<h3>Project 7.B</h3>
<p>Repeat Project 7.A for the sample skewness statistic. Compare the coverage rates for normal populations (skewness 0) and <span class="math inline">\(\chi^2(5)\)</span>distributions (positive skewness)</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>ske<span class="ot">&lt;-</span><span class="cf">function</span>(d)</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>dbar<span class="ot">&lt;-</span><span class="fu">mean</span>(d)</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>m3<span class="ot">&lt;-</span><span class="fu">mean</span>((d<span class="sc">-</span>dbar)<span class="sc">^</span><span class="dv">3</span>)</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>m2<span class="ot">&lt;-</span><span class="fu">mean</span>((d<span class="sc">-</span>dbar)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(m3<span class="sc">/</span>m2<span class="sc">^</span><span class="fl">1.5</span>)</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>b.skewness <span class="ot">&lt;-</span> <span class="cf">function</span>(x,i) {</span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>d<span class="ot">&lt;-</span>x[i,]</span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(<span class="fu">ske</span>(d))</span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co">#library(MASS)</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>nn<span class="ot">&lt;-</span><span class="fl">1e3</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span>MASS<span class="sc">::</span><span class="fu">mvrnorm</span>(nn,<span class="at">mu=</span><span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">2</span>),<span class="at">Sigma =</span> <span class="fu">diag</span>(<span class="dv">2</span>))</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>obj <span class="ot">&lt;-</span> boot<span class="sc">::</span><span class="fu">boot</span>(<span class="at">data=</span>x,<span class="at">statistic=</span>b.skewness,<span class="at">R=</span><span class="dv">2000</span>)</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(<span class="at">original=</span>obj<span class="sc">$</span>t0,<span class="at">bias=</span><span class="fu">mean</span>(obj<span class="sc">$</span>t)<span class="sc">-</span>obj<span class="sc">$</span>t0,</span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">se=</span><span class="fu">sd</span>(obj<span class="sc">$</span>t)),<span class="dv">3</span>)</span></code></pre></div>
<pre><code>## original     bias       se 
##   -0.013   -0.001    0.055</code></pre>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>alpha<span class="ot">&lt;-</span><span class="fu">c</span>(.<span class="dv">025</span>,.<span class="dv">975</span>)</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="co">#standard normal bootstrap confidence interval</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>sn<span class="ot">&lt;-</span>obj<span class="sc">$</span>t0<span class="sc">+</span><span class="fu">qnorm</span>(alpha)<span class="sc">*</span><span class="fu">sd</span>(obj<span class="sc">$</span>t)</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(sn)</span></code></pre></div>
<pre><code>## [1] -0.12076013  0.09460507</code></pre>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co">#basic bootstrap confidence interval</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>bb<span class="ot">&lt;-</span><span class="dv">2</span><span class="sc">*</span>obj<span class="sc">$</span>t0<span class="sc">-</span><span class="fu">quantile</span>(obj<span class="sc">$</span>t,<span class="fu">rev</span>(alpha),<span class="at">type =</span> <span class="dv">1</span>)</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(bb)</span></code></pre></div>
<pre><code>##      97.5%       2.5% 
## -0.1193111  0.0956280</code></pre>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co">#percentile bootstrap confidence interval</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>pb<span class="ot">&lt;-</span><span class="fu">quantile</span>(obj<span class="sc">$</span>t,alpha,<span class="at">type=</span><span class="dv">6</span>)</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(pb)</span></code></pre></div>
<pre><code>##       2.5%      97.5% 
## -0.1217761  0.0935088</code></pre>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="fl">1e3</span></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>p.val1<span class="ot">&lt;-</span>p.val2<span class="ot">&lt;-</span>p.val3<span class="ot">&lt;-</span><span class="fu">numeric</span>(m)</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>p.val1l<span class="ot">&lt;-</span>p.val2l<span class="ot">&lt;-</span>p.val3l<span class="ot">&lt;-</span><span class="fu">numeric</span>(m)</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>p.val1r<span class="ot">&lt;-</span>p.val2r<span class="ot">&lt;-</span>p.val3r<span class="ot">&lt;-</span><span class="fu">numeric</span>(m)</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m)</span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">&lt;-</span><span class="fu">rnorm</span>(nn)</span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>  skes<span class="ot">&lt;-</span><span class="fu">ske</span>(x)</span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>  p.val1l[i]<span class="ot">&lt;-</span><span class="fu">as.numeric</span>(skes<span class="sc">&lt;</span>sn[<span class="dv">1</span>])</span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a>  p.val1r[i]<span class="ot">&lt;-</span><span class="fu">as.numeric</span>(skes<span class="sc">&gt;</span>sn[<span class="dv">2</span>])</span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a>  p.val2l[i]<span class="ot">&lt;-</span><span class="fu">as.numeric</span>(skes<span class="sc">&lt;</span>bb[<span class="dv">1</span>])</span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true" tabindex="-1"></a>  p.val2r[i]<span class="ot">&lt;-</span><span class="fu">as.numeric</span>(skes<span class="sc">&gt;</span>bb[<span class="dv">2</span>])</span>
<span id="cb70-15"><a href="#cb70-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb70-16"><a href="#cb70-16" aria-hidden="true" tabindex="-1"></a>  p.val3l[i]<span class="ot">&lt;-</span><span class="fu">as.numeric</span>(skes<span class="sc">&lt;</span>pb[<span class="dv">1</span>])</span>
<span id="cb70-17"><a href="#cb70-17" aria-hidden="true" tabindex="-1"></a>  p.val3r[i]<span class="ot">&lt;-</span><span class="fu">as.numeric</span>(skes<span class="sc">&gt;</span>pb[<span class="dv">2</span>])</span>
<span id="cb70-18"><a href="#cb70-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb70-19"><a href="#cb70-19" aria-hidden="true" tabindex="-1"></a>  p.val1[i]<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">-</span>(p.val1l[i]<span class="sc">+</span>p.val1r[i])</span>
<span id="cb70-20"><a href="#cb70-20" aria-hidden="true" tabindex="-1"></a>  p.val2[i]<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">-</span>(p.val2l[i]<span class="sc">+</span>p.val2r[i])</span>
<span id="cb70-21"><a href="#cb70-21" aria-hidden="true" tabindex="-1"></a>  p.val3[i]<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">-</span>(p.val3l[i]<span class="sc">+</span>p.val3r[i])</span>
<span id="cb70-22"><a href="#cb70-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb70-23"><a href="#cb70-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb70-24"><a href="#cb70-24" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(<span class="fu">mean</span>(p.val1l),<span class="fu">mean</span>(p.val2l),<span class="fu">mean</span>(p.val3l)))</span></code></pre></div>
<pre><code>## [1] 0.052 0.052 0.049</code></pre>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(<span class="fu">mean</span>(p.val1r),<span class="fu">mean</span>(p.val2r),<span class="fu">mean</span>(p.val3r)))</span></code></pre></div>
<pre><code>## [1] 0.098 0.095 0.100</code></pre>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(<span class="fu">mean</span>(p.val1),<span class="fu">mean</span>(p.val2),<span class="fu">mean</span>(p.val3)))</span></code></pre></div>
<pre><code>## [1] 0.850 0.853 0.851</code></pre>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>nn<span class="ot">&lt;-</span><span class="fl">1e3</span></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">cbind</span>(<span class="fu">c</span>(<span class="fu">rchisq</span>(nn,<span class="at">df=</span><span class="dv">5</span>),<span class="fu">rchisq</span>(nn,<span class="at">df=</span><span class="dv">5</span>)))</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>obj <span class="ot">&lt;-</span> boot<span class="sc">::</span><span class="fu">boot</span>(<span class="at">data=</span>x,<span class="at">statistic=</span>b.skewness,<span class="at">R=</span><span class="dv">2000</span>)</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(<span class="at">original=</span>obj<span class="sc">$</span>t0,<span class="at">bias=</span><span class="fu">mean</span>(obj<span class="sc">$</span>t)<span class="sc">-</span>obj<span class="sc">$</span>t0,</span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">se=</span><span class="fu">sd</span>(obj<span class="sc">$</span>t)),<span class="dv">3</span>)</span></code></pre></div>
<pre><code>## original     bias       se 
##    1.084   -0.007    0.086</code></pre>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>alpha<span class="ot">&lt;-</span><span class="fu">c</span>(.<span class="dv">025</span>,.<span class="dv">975</span>)</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="co">#standard normal bootstrap confidence interval</span></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>sn<span class="ot">&lt;-</span>obj<span class="sc">$</span>t0<span class="sc">+</span><span class="fu">qnorm</span>(alpha)<span class="sc">*</span><span class="fu">sd</span>(obj<span class="sc">$</span>t)</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(sn)</span></code></pre></div>
<pre><code>## [1] 0.9157696 1.2513532</code></pre>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co">#basic bootstrap confidence interval</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>bb<span class="ot">&lt;-</span><span class="dv">2</span><span class="sc">*</span>obj<span class="sc">$</span>t0<span class="sc">-</span><span class="fu">quantile</span>(obj<span class="sc">$</span>t,<span class="fu">rev</span>(alpha),<span class="at">type =</span> <span class="dv">1</span>)</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(bb)</span></code></pre></div>
<pre><code>##     97.5%      2.5% 
## 0.9204616 1.2525630</code></pre>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co">#percentile bootstrap confidence interval</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>pb<span class="ot">&lt;-</span><span class="fu">quantile</span>(obj<span class="sc">$</span>t,alpha,<span class="at">type=</span><span class="dv">6</span>)</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(pb)</span></code></pre></div>
<pre><code>##      2.5%     97.5% 
## 0.9145606 1.2469603</code></pre>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="fl">1e3</span></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>p.val1<span class="ot">&lt;-</span>p.val2<span class="ot">&lt;-</span>p.val3<span class="ot">&lt;-</span><span class="fu">numeric</span>(m)</span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>p.val1l<span class="ot">&lt;-</span>p.val2l<span class="ot">&lt;-</span>p.val3l<span class="ot">&lt;-</span><span class="fu">numeric</span>(m)</span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>p.val1r<span class="ot">&lt;-</span>p.val2r<span class="ot">&lt;-</span>p.val3r<span class="ot">&lt;-</span><span class="fu">numeric</span>(m)</span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m)</span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">&lt;-</span><span class="fu">rchisq</span>(nn,<span class="at">df=</span><span class="dv">5</span>)</span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a>  skes<span class="ot">&lt;-</span><span class="fu">ske</span>(x)</span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a>  p.val1l[i]<span class="ot">&lt;-</span><span class="fu">as.numeric</span>(skes<span class="sc">&lt;</span>sn[<span class="dv">1</span>])</span>
<span id="cb84-11"><a href="#cb84-11" aria-hidden="true" tabindex="-1"></a>  p.val1r[i]<span class="ot">&lt;-</span><span class="fu">as.numeric</span>(skes<span class="sc">&gt;</span>sn[<span class="dv">2</span>])</span>
<span id="cb84-12"><a href="#cb84-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb84-13"><a href="#cb84-13" aria-hidden="true" tabindex="-1"></a>  p.val2l[i]<span class="ot">&lt;-</span><span class="fu">as.numeric</span>(skes<span class="sc">&lt;</span>bb[<span class="dv">1</span>])</span>
<span id="cb84-14"><a href="#cb84-14" aria-hidden="true" tabindex="-1"></a>  p.val2r[i]<span class="ot">&lt;-</span><span class="fu">as.numeric</span>(skes<span class="sc">&gt;</span>bb[<span class="dv">2</span>])</span>
<span id="cb84-15"><a href="#cb84-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb84-16"><a href="#cb84-16" aria-hidden="true" tabindex="-1"></a>  p.val3l[i]<span class="ot">&lt;-</span><span class="fu">as.numeric</span>(skes<span class="sc">&lt;</span>pb[<span class="dv">1</span>])</span>
<span id="cb84-17"><a href="#cb84-17" aria-hidden="true" tabindex="-1"></a>  p.val3r[i]<span class="ot">&lt;-</span><span class="fu">as.numeric</span>(skes<span class="sc">&gt;</span>pb[<span class="dv">2</span>])</span>
<span id="cb84-18"><a href="#cb84-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb84-19"><a href="#cb84-19" aria-hidden="true" tabindex="-1"></a>  p.val1[i]<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">-</span>(p.val1l[i]<span class="sc">+</span>p.val1r[i])</span>
<span id="cb84-20"><a href="#cb84-20" aria-hidden="true" tabindex="-1"></a>  p.val2[i]<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">-</span>(p.val2l[i]<span class="sc">+</span>p.val2r[i])</span>
<span id="cb84-21"><a href="#cb84-21" aria-hidden="true" tabindex="-1"></a>  p.val3[i]<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">-</span>(p.val3l[i]<span class="sc">+</span>p.val3r[i])</span>
<span id="cb84-22"><a href="#cb84-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb84-23"><a href="#cb84-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb84-24"><a href="#cb84-24" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(<span class="fu">mean</span>(p.val1l),<span class="fu">mean</span>(p.val2l),<span class="fu">mean</span>(p.val3l)))</span></code></pre></div>
<pre><code>## [1] 0.005 0.005 0.005</code></pre>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(<span class="fu">mean</span>(p.val1r),<span class="fu">mean</span>(p.val2r),<span class="fu">mean</span>(p.val3r)))</span></code></pre></div>
<pre><code>## [1] 0.456 0.451 0.469</code></pre>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(<span class="fu">mean</span>(p.val1),<span class="fu">mean</span>(p.val2),<span class="fu">mean</span>(p.val3)))</span></code></pre></div>
<pre><code>## [1] 0.539 0.544 0.526</code></pre>
</div>
</div>
<div id="hw6" class="section level2">
<h2>HW6</h2>
<div id="exercise-8.2" class="section level3">
<h3>Exercise 8.2</h3>
<p>Implement the bivariate Spearman rank correlation test for independence [255] as a permutation test. The Spearman rank correlation test statistic can be obtained from function cor with method = “spearman”. Compare the achieved significance level of the permutation test with the p-value reported by cor.test on the same samples</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">20</span></span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>R<span class="ot">&lt;-</span><span class="dv">9999</span></span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a><span class="co">#library(MASS)</span></span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a>reps<span class="ot">&lt;-</span><span class="fu">numeric</span>(R)</span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">rnorm</span>(n)</span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a>y<span class="ot">&lt;-</span><span class="fu">rnorm</span>(n)</span>
<span id="cb90-9"><a href="#cb90-9" aria-hidden="true" tabindex="-1"></a>t0<span class="ot">&lt;-</span><span class="fu">cor</span>(x,y)</span>
<span id="cb90-10"><a href="#cb90-10" aria-hidden="true" tabindex="-1"></a>z<span class="ot">&lt;-</span><span class="fu">c</span>(x,y)</span>
<span id="cb90-11"><a href="#cb90-11" aria-hidden="true" tabindex="-1"></a>K<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">:</span><span class="dv">20</span></span>
<span id="cb90-12"><a href="#cb90-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>R){</span>
<span id="cb90-13"><a href="#cb90-13" aria-hidden="true" tabindex="-1"></a>  k<span class="ot">&lt;-</span><span class="fu">sample</span>(K,<span class="at">size=</span>n,<span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb90-14"><a href="#cb90-14" aria-hidden="true" tabindex="-1"></a>  x1<span class="ot">&lt;-</span>z[k]</span>
<span id="cb90-15"><a href="#cb90-15" aria-hidden="true" tabindex="-1"></a>  y1<span class="ot">&lt;-</span>z[<span class="sc">-</span>k]</span>
<span id="cb90-16"><a href="#cb90-16" aria-hidden="true" tabindex="-1"></a>  reps[i]<span class="ot">&lt;-</span><span class="fu">cor</span>(x1,y1,<span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb90-17"><a href="#cb90-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb90-18"><a href="#cb90-18" aria-hidden="true" tabindex="-1"></a>p<span class="ot">&lt;-</span><span class="fu">mean</span>(<span class="fu">abs</span>(<span class="fu">c</span>(t0,reps))<span class="sc">&gt;=</span><span class="fu">abs</span>(t0))</span>
<span id="cb90-19"><a href="#cb90-19" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(p,<span class="fu">cor.test</span>(x,y)<span class="sc">$</span>p.value),<span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1] 0.747 0.745</code></pre>
</div>
<div id="supplementary" class="section level3">
<h3>Supplementary</h3>
<p>Design experiments for evaluating the performance of the NN, energy, and ball methods in various situations.</p>
<ul>
<li><p>Unequal variances and equal expectations</p></li>
<li><p>Unequal variances and unequal expectations</p></li>
<li><p>Non-normal distributions: t distribution with 1 df (heavy-tailed distribution), bimodel distribution (mixture of two normal distributions)</p></li>
<li><p>Unbalanced samples (say, 1 case versus 10 controls)</p></li>
<li><p>Note: The parameters should be chosen such that the powers are distinguishable (say, range from 0.3 to 0.8)</p></li>
</ul>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="co">#library(RANN)</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a><span class="co">#library(energy)</span></span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a><span class="co">#library(Ball)</span></span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a><span class="co">#library(boot)</span></span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>Tn <span class="ot">&lt;-</span> <span class="cf">function</span>(z, ix, sizes,k) {</span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a>  n1 <span class="ot">&lt;-</span> sizes[<span class="dv">1</span>]; n2 <span class="ot">&lt;-</span> sizes[<span class="dv">2</span>]; n <span class="ot">&lt;-</span> n1 <span class="sc">+</span> n2</span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">is.vector</span>(z)) z <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(z,<span class="dv">0</span>);</span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a>  z <span class="ot">&lt;-</span> z[ix, ];</span>
<span id="cb92-9"><a href="#cb92-9" aria-hidden="true" tabindex="-1"></a>  NN <span class="ot">&lt;-</span> RANN<span class="sc">::</span><span class="fu">nn2</span>(<span class="at">data=</span>z, <span class="at">k=</span>k<span class="sc">+</span><span class="dv">1</span>) <span class="co"># what&#39;s the first column?</span></span>
<span id="cb92-10"><a href="#cb92-10" aria-hidden="true" tabindex="-1"></a>  block1 <span class="ot">&lt;-</span> NN<span class="sc">$</span>nn.idx[<span class="dv">1</span><span class="sc">:</span>n1,<span class="sc">-</span><span class="dv">1</span>] </span>
<span id="cb92-11"><a href="#cb92-11" aria-hidden="true" tabindex="-1"></a>  block2 <span class="ot">&lt;-</span> NN<span class="sc">$</span>nn.idx[(n1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n,<span class="sc">-</span><span class="dv">1</span>] </span>
<span id="cb92-12"><a href="#cb92-12" aria-hidden="true" tabindex="-1"></a>  i1 <span class="ot">&lt;-</span> <span class="fu">sum</span>(block1 <span class="sc">&lt;</span> n1 <span class="sc">+</span> .<span class="dv">5</span>); i2 <span class="ot">&lt;-</span> <span class="fu">sum</span>(block2 <span class="sc">&gt;</span> n1<span class="fl">+.5</span>) </span>
<span id="cb92-13"><a href="#cb92-13" aria-hidden="true" tabindex="-1"></a>  (i1 <span class="sc">+</span> i2) <span class="sc">/</span> (k <span class="sc">*</span> n)</span>
<span id="cb92-14"><a href="#cb92-14" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">50</span>; k<span class="ot">&lt;-</span><span class="dv">3</span>; p<span class="ot">&lt;-</span><span class="dv">2</span>; mu <span class="ot">&lt;-</span> <span class="fl">0.3</span>; <span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> n2 <span class="ot">&lt;-</span> <span class="dv">50</span>; R<span class="ot">&lt;-</span><span class="dv">999</span>; n <span class="ot">&lt;-</span> n1<span class="sc">+</span>n2; N <span class="ot">=</span> <span class="fu">c</span>(n1,n2)</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>eqdist.nn <span class="ot">&lt;-</span> <span class="cf">function</span>(z,sizes,k){</span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>  boot.obj <span class="ot">&lt;-</span> boot<span class="sc">::</span><span class="fu">boot</span>(<span class="at">data=</span>z,<span class="at">statistic=</span>Tn,<span class="at">R=</span>R,</span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="at">sizes =</span> sizes,<span class="at">k=</span>k)</span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>  ts <span class="ot">&lt;-</span> <span class="fu">c</span>(boot.obj<span class="sc">$</span>t0,boot.obj<span class="sc">$</span>t)</span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a>  p.value <span class="ot">&lt;-</span> <span class="fu">mean</span>(ts<span class="sc">&gt;=</span>ts[<span class="dv">1</span>])</span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">statistic=</span>ts[<span class="dv">1</span>],<span class="at">p.value=</span>p.value)</span>
<span id="cb93-9"><a href="#cb93-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb93-10"><a href="#cb93-10" aria-hidden="true" tabindex="-1"></a>p.values <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,m,<span class="dv">3</span>)</span></code></pre></div>
<ul>
<li>Unequal variances and equal expectations</li>
</ul>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1235</span>)</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n1<span class="sc">*</span>p,<span class="dv">0</span>,<span class="fl">1.37</span>),<span class="at">ncol=</span>p);</span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">rnorm</span>(n2),<span class="fu">rnorm</span>(n2));</span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>  z <span class="ot">&lt;-</span> <span class="fu">rbind</span>(x,y)</span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a>  p.values[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">eqdist.nn</span>(z,N,k)<span class="sc">$</span>p.value</span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a>  p.values[i,<span class="dv">2</span>] <span class="ot">&lt;-</span> energy<span class="sc">::</span><span class="fu">eqdist.etest</span>(z,<span class="at">sizes=</span>N,<span class="at">R=</span>R)<span class="sc">$</span>p.value</span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a>  p.values[i,<span class="dv">3</span>] <span class="ot">&lt;-</span> Ball<span class="sc">::</span><span class="fu">bd.test</span>(<span class="at">x=</span>x,<span class="at">y=</span>y,<span class="at">num.permutations=</span><span class="dv">999</span>,<span class="at">seed=</span>i<span class="sc">*</span><span class="dv">12</span>)<span class="sc">$</span>p.value</span>
<span id="cb94-9"><a href="#cb94-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb94-10"><a href="#cb94-10" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.1</span>; </span>
<span id="cb94-11"><a href="#cb94-11" aria-hidden="true" tabindex="-1"></a>pow <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(p.values<span class="sc">&lt;</span>alpha)</span>
<span id="cb94-12"><a href="#cb94-12" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(pow)</span></code></pre></div>
<pre><code>## [1] 0.26 0.34 0.76</code></pre>
<ul>
<li>Unequal variances and unequal expectations</li>
</ul>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12455</span>)</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n1<span class="sc">*</span>p,<span class="fl">0.1</span>,<span class="fl">1.37</span>),<span class="at">ncol=</span>p);</span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">rnorm</span>(n2),<span class="fu">rnorm</span>(n2));</span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a>  z <span class="ot">&lt;-</span> <span class="fu">rbind</span>(x,y)</span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a>  p.values[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">eqdist.nn</span>(z,N,k)<span class="sc">$</span>p.value</span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a>  p.values[i,<span class="dv">2</span>] <span class="ot">&lt;-</span> energy<span class="sc">::</span><span class="fu">eqdist.etest</span>(z,<span class="at">sizes=</span>N,<span class="at">R=</span>R)<span class="sc">$</span>p.value</span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true" tabindex="-1"></a>  p.values[i,<span class="dv">3</span>] <span class="ot">&lt;-</span> Ball<span class="sc">::</span><span class="fu">bd.test</span>(<span class="at">x=</span>x,<span class="at">y=</span>y,<span class="at">num.permutations=</span><span class="dv">999</span>,<span class="at">seed=</span>i<span class="sc">*</span><span class="dv">123</span>)<span class="sc">$</span>p.value</span>
<span id="cb96-9"><a href="#cb96-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb96-10"><a href="#cb96-10" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.1</span>; </span>
<span id="cb96-11"><a href="#cb96-11" aria-hidden="true" tabindex="-1"></a>pow <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(p.values<span class="sc">&lt;</span>alpha)</span>
<span id="cb96-12"><a href="#cb96-12" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(pow)</span></code></pre></div>
<pre><code>## [1] 0.36 0.40 0.76</code></pre>
<ul>
<li>Non-normal distributions: t distribution with 1 df (heavy-tailed distribution), bimodel distribution (mixture of two normal distributions)</li>
</ul>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12455</span>)</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rt</span>(n1<span class="sc">*</span>p,<span class="dv">1</span>),<span class="at">ncol=</span>p);</span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>  y1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n1<span class="sc">*</span>p,<span class="dv">0</span>,<span class="dv">1</span>);</span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a>  y2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n1<span class="sc">*</span>p,<span class="dv">1</span>,<span class="fl">2.8</span>);</span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a>  r<span class="ot">&lt;-</span><span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),n1<span class="sc">*</span>p,<span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a>  y0<span class="ot">&lt;-</span>r<span class="sc">*</span>y1<span class="sc">+</span>(<span class="dv">1</span><span class="sc">-</span>r)<span class="sc">*</span>y2</span>
<span id="cb98-8"><a href="#cb98-8" aria-hidden="true" tabindex="-1"></a>  y<span class="ot">&lt;-</span><span class="fu">matrix</span>(y0,<span class="at">ncol =</span> p)</span>
<span id="cb98-9"><a href="#cb98-9" aria-hidden="true" tabindex="-1"></a>  z <span class="ot">&lt;-</span> <span class="fu">rbind</span>(x,y)</span>
<span id="cb98-10"><a href="#cb98-10" aria-hidden="true" tabindex="-1"></a>  p.values[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">eqdist.nn</span>(z,N,k)<span class="sc">$</span>p.value</span>
<span id="cb98-11"><a href="#cb98-11" aria-hidden="true" tabindex="-1"></a>  p.values[i,<span class="dv">2</span>] <span class="ot">&lt;-</span> energy<span class="sc">::</span><span class="fu">eqdist.etest</span>(z,<span class="at">sizes=</span>N,<span class="at">R=</span>R)<span class="sc">$</span>p.value</span>
<span id="cb98-12"><a href="#cb98-12" aria-hidden="true" tabindex="-1"></a>  p.values[i,<span class="dv">3</span>] <span class="ot">&lt;-</span> Ball<span class="sc">::</span><span class="fu">bd.test</span>(<span class="at">x=</span>x,<span class="at">y=</span>y,<span class="at">num.permutations=</span><span class="dv">999</span>,<span class="at">seed=</span>i<span class="sc">*</span><span class="dv">12345</span>)<span class="sc">$</span>p.value</span>
<span id="cb98-13"><a href="#cb98-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb98-14"><a href="#cb98-14" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.1</span>; </span>
<span id="cb98-15"><a href="#cb98-15" aria-hidden="true" tabindex="-1"></a>pow <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(p.values<span class="sc">&lt;</span>alpha)</span>
<span id="cb98-16"><a href="#cb98-16" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(pow)</span></code></pre></div>
<pre><code>## [1] 0.28 0.70 0.48</code></pre>
<ul>
<li>Unbalanced samples (say, 1 case versus 10 controls)</li>
</ul>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fl">1e2</span>; k<span class="ot">&lt;-</span><span class="dv">3</span>; p<span class="ot">&lt;-</span><span class="dv">2</span>; mu <span class="ot">&lt;-</span> <span class="fl">0.3</span>; <span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>n1 <span class="ot">&lt;-</span><span class="dv">10</span>; n2 <span class="ot">&lt;-</span> <span class="dv">90</span>; R<span class="ot">&lt;-</span><span class="dv">999</span>; n <span class="ot">&lt;-</span> n1<span class="sc">+</span>n2; N <span class="ot">=</span> <span class="fu">c</span>(n1,n2)</span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>eqdist.nn <span class="ot">&lt;-</span> <span class="cf">function</span>(z,sizes,k){</span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>  boot.obj <span class="ot">&lt;-</span> boot<span class="sc">::</span><span class="fu">boot</span>(<span class="at">data=</span>z,<span class="at">statistic=</span>Tn,<span class="at">R=</span>R,</span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="at">sizes =</span> sizes,<span class="at">k=</span>k)</span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a>  ts <span class="ot">&lt;-</span> <span class="fu">c</span>(boot.obj<span class="sc">$</span>t0,boot.obj<span class="sc">$</span>t)</span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true" tabindex="-1"></a>  p.value <span class="ot">&lt;-</span> <span class="fu">mean</span>(ts<span class="sc">&gt;=</span>ts[<span class="dv">1</span>])</span>
<span id="cb100-8"><a href="#cb100-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">statistic=</span>ts[<span class="dv">1</span>],<span class="at">p.value=</span>p.value)</span>
<span id="cb100-9"><a href="#cb100-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb100-10"><a href="#cb100-10" aria-hidden="true" tabindex="-1"></a>p.values <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb100-11"><a href="#cb100-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb100-12"><a href="#cb100-12" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n1<span class="sc">*</span>p,<span class="dv">0</span>,<span class="fl">1.55</span>),<span class="at">ncol=</span>p);</span>
<span id="cb100-13"><a href="#cb100-13" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">rnorm</span>(n2),<span class="fu">rnorm</span>(n2));</span>
<span id="cb100-14"><a href="#cb100-14" aria-hidden="true" tabindex="-1"></a>  z <span class="ot">&lt;-</span> <span class="fu">rbind</span>(x,y)</span>
<span id="cb100-15"><a href="#cb100-15" aria-hidden="true" tabindex="-1"></a>  p.values[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">eqdist.nn</span>(z,N,k)<span class="sc">$</span>p.value</span>
<span id="cb100-16"><a href="#cb100-16" aria-hidden="true" tabindex="-1"></a>  p.values[i,<span class="dv">2</span>] <span class="ot">&lt;-</span> energy<span class="sc">::</span><span class="fu">eqdist.etest</span>(z,<span class="at">sizes=</span>N,<span class="at">R=</span>R)<span class="sc">$</span>p.value</span>
<span id="cb100-17"><a href="#cb100-17" aria-hidden="true" tabindex="-1"></a>  p.values[i,<span class="dv">3</span>] <span class="ot">&lt;-</span> Ball<span class="sc">::</span><span class="fu">bd.test</span>(<span class="at">x=</span>x,<span class="at">y=</span>y,<span class="at">num.permutations=</span><span class="dv">999</span>,<span class="at">seed=</span>i<span class="sc">*</span><span class="dv">12345</span>)<span class="sc">$</span>p.value</span>
<span id="cb100-18"><a href="#cb100-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb100-19"><a href="#cb100-19" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.1</span>; </span>
<span id="cb100-20"><a href="#cb100-20" aria-hidden="true" tabindex="-1"></a>pow <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(p.values<span class="sc">&lt;</span>alpha)</span>
<span id="cb100-21"><a href="#cb100-21" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(pow)</span></code></pre></div>
<pre><code>## [1] 0.51 0.56 0.44</code></pre>
</div>
</div>
<div id="hw7" class="section level2">
<h2>HW7</h2>
<div id="exercise-9.3" class="section level3">
<h3>EXERCISE 9.3</h3>
<p>Use the Metropolis-Hastings sampler to generate random variables from a standard Cauchy distribution. Discard the first 1000 of the chain, and compare the deciles of the generated observations with the deciles of the standard Cauchy distribution (see <em>qcauchy</em> or <em>qt</em> with df=1). Recall that a Cauchy(<span class="math inline">\(\theta,\eta\)</span>) distribution has density function</p>
<p><span class="math display">\[
f(x)=\frac{1}{\theta\pi(1+[(x-\eta)/\theta]^2)},\quad -\infty&lt;x&lt;\infty,\theta&gt;0.
\]</span></p>
<p>The standard Cauchy has the Cauchy(<span class="math inline">\(\theta=1,\eta=0\)</span>) density. (Note that the standard Cauchy density is equal to the Student t density with one degree of freedom.)</p>
<p>Use the Gelman-Rubin method to monitor convergence of chain, and run the chain until it converges approximately to the target distributioon according to <span class="math inline">\(\hat{R}&lt;1.2\)</span>.</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>f<span class="ot">&lt;-</span><span class="cf">function</span>(x,<span class="at">theta=</span><span class="dv">1</span>,<span class="at">eta=</span><span class="dv">0</span>){</span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stopifnot</span>(theta<span class="sc">&gt;</span><span class="dv">0</span>)</span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="dv">1</span><span class="sc">/</span>(theta<span class="sc">*</span>pi<span class="sc">*</span>(<span class="dv">1</span><span class="sc">+</span>((x<span class="sc">-</span>eta)<span class="sc">/</span>theta)<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>m  <span class="ot">&lt;-</span>  <span class="dv">10000</span></span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>sigma  <span class="ot">&lt;-</span><span class="fl">2.7</span></span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a>x  <span class="ot">&lt;-</span>  <span class="fu">numeric</span>(m)</span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a>x[<span class="dv">1</span>]  <span class="ot">&lt;-</span>  <span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="at">mean=</span><span class="dv">0</span>,<span class="at">sd=</span>sigma)</span>
<span id="cb103-7"><a href="#cb103-7" aria-hidden="true" tabindex="-1"></a><span class="co">#x[1]&lt;-5</span></span>
<span id="cb103-8"><a href="#cb103-8" aria-hidden="true" tabindex="-1"></a>k  <span class="ot">&lt;-</span>  <span class="dv">0</span></span>
<span id="cb103-9"><a href="#cb103-9" aria-hidden="true" tabindex="-1"></a>u  <span class="ot">&lt;-</span>  <span class="fu">runif</span>(m)</span>
<span id="cb103-10"><a href="#cb103-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>  (i  <span class="cf">in</span>  <span class="dv">2</span><span class="sc">:</span>m)  {</span>
<span id="cb103-11"><a href="#cb103-11" aria-hidden="true" tabindex="-1"></a>xt  <span class="ot">&lt;-</span>  x[i<span class="dv">-1</span>]</span>
<span id="cb103-12"><a href="#cb103-12" aria-hidden="true" tabindex="-1"></a>y  <span class="ot">&lt;-</span>  <span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="at">mean=</span>xt,<span class="at">sd=</span>sigma)</span>
<span id="cb103-13"><a href="#cb103-13" aria-hidden="true" tabindex="-1"></a>num <span class="ot">&lt;-</span> <span class="fu">f</span>(y) <span class="sc">*</span> <span class="fu">dnorm</span>(xt, <span class="at">mean=</span>y,<span class="at">sd =</span> sigma)</span>
<span id="cb103-14"><a href="#cb103-14" aria-hidden="true" tabindex="-1"></a>den <span class="ot">&lt;-</span> <span class="fu">f</span>(xt) <span class="sc">*</span> <span class="fu">dnorm</span>(y,<span class="at">mean=</span>xt ,<span class="at">sd=</span>sigma)</span>
<span id="cb103-15"><a href="#cb103-15" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>  (u[i]  <span class="sc">&lt;=</span> num<span class="sc">/</span>den ) x[i]  <span class="ot">&lt;-</span>  y  <span class="cf">else</span>  {</span>
<span id="cb103-16"><a href="#cb103-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-17"><a href="#cb103-17" aria-hidden="true" tabindex="-1"></a>x[i]  <span class="ot">&lt;-</span>  xt</span>
<span id="cb103-18"><a href="#cb103-18" aria-hidden="true" tabindex="-1"></a>k  <span class="ot">&lt;-</span>  k<span class="sc">+</span><span class="dv">1</span>         <span class="co">#y  is  rejected</span></span>
<span id="cb103-19"><a href="#cb103-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb103-20"><a href="#cb103-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb103-21"><a href="#cb103-21" aria-hidden="true" tabindex="-1"></a>index <span class="ot">&lt;-</span> <span class="dv">5000</span><span class="sc">:</span><span class="dv">5500</span></span>
<span id="cb103-22"><a href="#cb103-22" aria-hidden="true" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> x[index]</span>
<span id="cb103-23"><a href="#cb103-23" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(index, y1, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">main=</span><span class="st">&quot;&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;x&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="do">###  compare the deciles of the generated observations </span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a><span class="do">###  with the deciles of the standard Cauchy distribution</span></span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">1001</span> <span class="co">#discard the burnin sample</span></span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> x[b<span class="sc">:</span>m]</span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">ppoints</span>(<span class="dv">10</span>)</span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a>QR <span class="ot">&lt;-</span> <span class="fu">qt</span>(a,<span class="at">df=</span><span class="dv">1</span>) <span class="co">#quantiles of Cauchy</span></span>
<span id="cb104-7"><a href="#cb104-7" aria-hidden="true" tabindex="-1"></a>Q <span class="ot">&lt;-</span> <span class="fu">quantile</span>(x, a)</span>
<span id="cb104-8"><a href="#cb104-8" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(QR, Q, <span class="at">main=</span><span class="st">&quot;&quot;</span>,</span>
<span id="cb104-9"><a href="#cb104-9" aria-hidden="true" tabindex="-1"></a><span class="at">xlab=</span><span class="st">&quot;Cauchy Quantiles&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Sample Quantiles&quot;</span>)</span>
<span id="cb104-10"><a href="#cb104-10" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(Q)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(y, <span class="at">breaks=</span><span class="st">&quot;scott&quot;</span>, <span class="at">main=</span><span class="st">&quot;&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">freq=</span><span class="cn">FALSE</span>)</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(QR, <span class="fu">f</span>(QR, <span class="at">theta =</span> <span class="dv">1</span>,<span class="at">eta=</span><span class="dv">0</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div id="gelman-rubin-method" class="section level4">
<h4>Gelman-Rubin method</h4>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>Gelman.Rubin <span class="ot">&lt;-</span> <span class="cf">function</span>(psi) {</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a><span class="co"># psi[i,j] is the statistic psi(X[i,1:j])</span></span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a><span class="co"># for chain in i-th row of X</span></span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a>psi <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(psi)</span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">ncol</span>(psi)</span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="fu">nrow</span>(psi)</span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true" tabindex="-1"></a>psi.means <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(psi) <span class="co">#row means</span></span>
<span id="cb106-8"><a href="#cb106-8" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> n <span class="sc">*</span> <span class="fu">var</span>(psi.means) <span class="co">#between variance est.</span></span>
<span id="cb106-9"><a href="#cb106-9" aria-hidden="true" tabindex="-1"></a>psi.w <span class="ot">&lt;-</span> <span class="fu">apply</span>(psi, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>) <span class="co">#within variances</span></span>
<span id="cb106-10"><a href="#cb106-10" aria-hidden="true" tabindex="-1"></a>W <span class="ot">&lt;-</span> <span class="fu">mean</span>(psi.w) <span class="co">#within est.</span></span>
<span id="cb106-11"><a href="#cb106-11" aria-hidden="true" tabindex="-1"></a>v.hat <span class="ot">&lt;-</span> W<span class="sc">*</span>(n<span class="dv">-1</span>)<span class="sc">/</span>n <span class="sc">+</span> (B<span class="sc">/</span>n) <span class="co">#upper variance est.</span></span>
<span id="cb106-12"><a href="#cb106-12" aria-hidden="true" tabindex="-1"></a>r.hat <span class="ot">&lt;-</span> v.hat <span class="sc">/</span> W <span class="co">#G-R statistic</span></span>
<span id="cb106-13"><a href="#cb106-13" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(r.hat)</span>
<span id="cb106-14"><a href="#cb106-14" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>cauchy.chain <span class="ot">&lt;-</span> <span class="cf">function</span>(sigma, N, x1){</span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>x  <span class="ot">&lt;-</span>  <span class="fu">numeric</span>(N)</span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>x[<span class="dv">1</span>]  <span class="ot">&lt;-</span> x1</span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a>k  <span class="ot">&lt;-</span>  <span class="dv">0</span></span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a>u  <span class="ot">&lt;-</span>  <span class="fu">runif</span>(N)</span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>  (i  <span class="cf">in</span>  <span class="dv">2</span><span class="sc">:</span>N)  {</span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a>xt  <span class="ot">&lt;-</span>  x[i<span class="dv">-1</span>]</span>
<span id="cb107-8"><a href="#cb107-8" aria-hidden="true" tabindex="-1"></a>y  <span class="ot">&lt;-</span>  <span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="at">mean=</span>xt,<span class="at">sd=</span>sigma)</span>
<span id="cb107-9"><a href="#cb107-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-10"><a href="#cb107-10" aria-hidden="true" tabindex="-1"></a>num <span class="ot">&lt;-</span> <span class="fu">f</span>(y) <span class="sc">*</span> <span class="fu">dnorm</span>(xt, <span class="at">mean=</span>y,<span class="at">sd =</span> sigma)</span>
<span id="cb107-11"><a href="#cb107-11" aria-hidden="true" tabindex="-1"></a>den <span class="ot">&lt;-</span> <span class="fu">f</span>(xt) <span class="sc">*</span> <span class="fu">dnorm</span>(y,<span class="at">mean=</span>xt ,<span class="at">sd=</span>sigma)</span>
<span id="cb107-12"><a href="#cb107-12" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>  (u[i]  <span class="sc">&lt;=</span> num<span class="sc">/</span>den ) x[i]  <span class="ot">&lt;-</span>  y  <span class="cf">else</span>  {</span>
<span id="cb107-13"><a href="#cb107-13" aria-hidden="true" tabindex="-1"></a>x[i]  <span class="ot">&lt;-</span>  xt</span>
<span id="cb107-14"><a href="#cb107-14" aria-hidden="true" tabindex="-1"></a>k  <span class="ot">&lt;-</span>  k<span class="sc">+</span><span class="dv">1</span>         <span class="co">#y  is  rejected</span></span>
<span id="cb107-15"><a href="#cb107-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb107-16"><a href="#cb107-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb107-17"><a href="#cb107-17" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(x)</span>
<span id="cb107-18"><a href="#cb107-18" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fl">0.2</span> <span class="co">#parameter of proposal distribution</span></span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">4</span> <span class="co">#number of chains to generate</span></span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10000</span> <span class="co">#length of chains</span></span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="co">#burn-in length</span></span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a><span class="co">#choose overdispersed initial values</span></span>
<span id="cb108-7"><a href="#cb108-7" aria-hidden="true" tabindex="-1"></a>x0 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="sc">-</span><span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="dv">1</span>)</span>
<span id="cb108-8"><a href="#cb108-8" aria-hidden="true" tabindex="-1"></a><span class="co">#generate the chains</span></span>
<span id="cb108-9"><a href="#cb108-9" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow=</span>k, <span class="at">ncol=</span>n)</span>
<span id="cb108-10"><a href="#cb108-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k)</span>
<span id="cb108-11"><a href="#cb108-11" aria-hidden="true" tabindex="-1"></a>X[i, ] <span class="ot">&lt;-</span> <span class="fu">cauchy.chain</span>(sigma, n, x0[i])</span>
<span id="cb108-12"><a href="#cb108-12" aria-hidden="true" tabindex="-1"></a><span class="co">#compute diagnostic statistics</span></span>
<span id="cb108-13"><a href="#cb108-13" aria-hidden="true" tabindex="-1"></a>psi <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(X, <span class="dv">1</span>, cumsum))</span>
<span id="cb108-14"><a href="#cb108-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(psi))</span>
<span id="cb108-15"><a href="#cb108-15" aria-hidden="true" tabindex="-1"></a>psi[i,] <span class="ot">&lt;-</span> psi[i,] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi))</span>
<span id="cb108-16"><a href="#cb108-16" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">Gelman.Rubin</span>(psi))</span></code></pre></div>
<pre><code>## [1] 1.063909</code></pre>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="co">#plot psi for the four chains</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a><span class="co">#par(mfrow=c(2,2))</span></span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k)</span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(psi[i, (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n], <span class="at">type=</span><span class="st">&quot;l&quot;</span>,</span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a><span class="at">xlab=</span>i, <span class="at">ylab=</span><span class="fu">bquote</span>(psi))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="co">#par(mfrow=c(1,1)) #restore default</span></span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a><span class="co">#plot the sequence of R-hat statistics</span></span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>rhat <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, n)</span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n)</span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a>rhat[j] <span class="ot">&lt;-</span> <span class="fu">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="sc">:</span>j])</span>
<span id="cb111-6"><a href="#cb111-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rhat[(b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n], <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;R&quot;</span>)</span>
<span id="cb111-7"><a href="#cb111-7" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fl">1.2</span>, <span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>It shows that it converges approximately to the target distributioon according to <span class="math inline">\(\hat{R}&lt;1.2\)</span>.</p>
</div>
</div>
<div id="exercise-9.8" class="section level3">
<h3>EXERCISE 9.8</h3>
<p>This example appears in [40]. Consider the bivariate density <span class="math display">\[
f (x, y) \propto \binom{n}{x}y^{x+a-1}(1 − y)^{n-x+b-1},    x = 0, 1,\cdots, n, 0 \leq y \leq 1.
\]</span> It can be shown (see e.g. [23]) that for ﬁxed <span class="math inline">\(a, b, n\)</span>, the conditional distributions are Binomial<span class="math inline">\((n, y)\)</span> and Beta<span class="math inline">\((x + a, n - x + b)\)</span>. Use the Gibbs sampler to generate a chain with target joint density <span class="math inline">\(f (x, y)\)</span>.</p>
<p>Use the Gelman-Rubin method to monitor convergence of chain, and run the chain until it converges approximately to the target distributioon according to <span class="math inline">\(\hat{R}&lt;1.2\)</span>.</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">5000</span> <span class="co">#length of chain</span></span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>burn <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="co">#burn-in length</span></span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>) <span class="co">#the chain, a bivariate sample</span></span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a>a<span class="ot">=</span><span class="dv">5</span></span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a>b<span class="ot">=</span><span class="dv">4</span></span>
<span id="cb112-7"><a href="#cb112-7" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="dv">20</span></span>
<span id="cb112-8"><a href="#cb112-8" aria-hidden="true" tabindex="-1"></a>x<span class="ot">=</span><span class="dv">1</span>;y<span class="ot">=</span><span class="fl">0.5</span></span>
<span id="cb112-9"><a href="#cb112-9" aria-hidden="true" tabindex="-1"></a>bichain<span class="ot">&lt;-</span><span class="cf">function</span>(<span class="at">N=</span><span class="dv">5000</span>,<span class="at">burn=</span><span class="dv">1000</span>,<span class="at">a=</span><span class="dv">5</span>,<span class="at">b=</span><span class="dv">4</span>,<span class="at">n=</span><span class="dv">20</span>,<span class="at">x=</span><span class="dv">1</span>,<span class="at">y=</span><span class="fl">0.5</span>,<span class="at">plot=</span><span class="cn">FALSE</span>){</span>
<span id="cb112-10"><a href="#cb112-10" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>)</span>
<span id="cb112-11"><a href="#cb112-11" aria-hidden="true" tabindex="-1"></a>  X[<span class="dv">1</span>, ] <span class="ot">&lt;-</span> <span class="fu">c</span>(x,y) <span class="co">#initialize</span></span>
<span id="cb112-12"><a href="#cb112-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb112-13"><a href="#cb112-13" aria-hidden="true" tabindex="-1"></a>X[i, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>,<span class="at">size=</span>n,<span class="at">prob=</span>y)</span>
<span id="cb112-14"><a href="#cb112-14" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span>X[i,<span class="dv">1</span>]</span>
<span id="cb112-15"><a href="#cb112-15" aria-hidden="true" tabindex="-1"></a>X[i, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="at">n=</span><span class="dv">1</span>,<span class="at">shape1 =</span> x<span class="sc">+</span>a,<span class="at">shape2 =</span> n<span class="sc">-</span>x<span class="sc">+</span>b)</span>
<span id="cb112-16"><a href="#cb112-16" aria-hidden="true" tabindex="-1"></a>y<span class="ot">&lt;-</span>X[i,<span class="dv">2</span>]</span>
<span id="cb112-17"><a href="#cb112-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb112-18"><a href="#cb112-18" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> burn <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb112-19"><a href="#cb112-19" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> X[b<span class="sc">:</span>N, ]</span>
<span id="cb112-20"><a href="#cb112-20" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(plot <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb112-21"><a href="#cb112-21" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, <span class="at">main=</span><span class="st">&quot;&quot;</span>, <span class="at">cex=</span>.<span class="dv">5</span>, <span class="at">xlab=</span><span class="st">&quot;x&quot;</span>,</span>
<span id="cb112-22"><a href="#cb112-22" aria-hidden="true" tabindex="-1"></a><span class="at">ylab=</span><span class="st">&quot;y&quot;</span>, <span class="at">ylim=</span><span class="fu">range</span>(x[,<span class="dv">2</span>]))</span>
<span id="cb112-23"><a href="#cb112-23" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span> </span>
<span id="cb112-24"><a href="#cb112-24" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(X)</span>
<span id="cb112-25"><a href="#cb112-25" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb112-26"><a href="#cb112-26" aria-hidden="true" tabindex="-1"></a><span class="fu">bichain</span>(<span class="at">plot=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div id="gelman-rubin-method-1" class="section level4">
<h4>Gelman-Rubin method</h4>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(R2OpenBUGS)</span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MCMCglmm)</span></code></pre></div>
<pre><code>## 载入需要的程辑包：Matrix</code></pre>
<pre><code>## 载入需要的程辑包：coda</code></pre>
<pre><code>## 载入需要的程辑包：ape</code></pre>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>DATA1<span class="ot">&lt;-</span> <span class="fu">mcmc</span>(<span class="at">data=</span><span class="fu">cbind</span>(<span class="fu">bichain</span>(<span class="at">x =</span> <span class="dv">1</span>,<span class="at">y=</span><span class="fl">0.2</span>,<span class="at">a=</span><span class="dv">10</span>,<span class="at">N=</span><span class="dv">5000</span>)))</span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>DATA2<span class="ot">&lt;-</span> <span class="fu">mcmc</span>(<span class="at">data=</span><span class="fu">cbind</span>(<span class="fu">bichain</span>(<span class="at">x=</span> <span class="dv">10</span>,<span class="at">y=</span><span class="fl">0.8</span>,<span class="at">a=</span><span class="dv">10</span>,<span class="at">N=</span><span class="dv">5000</span>)))</span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a><span class="fu">gelman.plot</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="fu">mcmc.list</span>(DATA1),<span class="fu">mcmc.list</span>(DATA2)))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --> It shows that it converges approximately to the target distributioon according to <span class="math inline">\(\hat{R}&lt;1.2\)</span>. ## HW8</p>
</div>
</div>
<div id="exercise-11.3" class="section level3">
<h3>EXERCISE 11.3</h3>
<ol style="list-style-type: lower-alpha">
<li><p>Write a function to compute the <span class="math inline">\(k^{th}\)</span> term in <span class="math display">\[
\sum_{k=0}^{\infty}\frac{(-1)^k}{k!2^k}\frac{||a||^{2k+2}}{(2k+1)(2k+2)}\frac{\Gamma(\frac{d+1}{2})\Gamma(k+\frac{3}{2})}{\Gamma(k+\frac{d}{2}+1)},
\]</span> where <span class="math inline">\(d\geq 1\)</span> is an integer, <span class="math inline">\(a\)</span> is a vector in <span class="math inline">\(\mathbb{R}^d\)</span>, and <span class="math inline">\(||\cdot||\)</span> denotes the Euclidean norm. Perform the arithmetic so that the coefficients can be computed for (almost) arbitrarily large k and d. (This sum converges for all <span class="math inline">\(a\in\mathbb{R}^d\)</span>).</p></li>
<li><p>Modify the function so that it computes and returns the sum.</p></li>
<li><p>Evaluate the sum when <span class="math inline">\(a = (1, 2)^T .\)</span></p></li>
<li></li>
</ol>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>ft<span class="ot">&lt;-</span><span class="cf">function</span>(a,<span class="at">n=</span><span class="fl">1e7</span>,<span class="at">eps=</span><span class="fl">1e-9</span>,<span class="at">plot=</span><span class="st">&quot;TRUE&quot;</span>)</span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>{ <span class="do">## 输入参数：</span></span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a>  <span class="do">## a为d维实值向量</span></span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a>  <span class="do">## n为最大迭代次数,默认取1e7</span></span>
<span id="cb118-5"><a href="#cb118-5" aria-hidden="true" tabindex="-1"></a>  <span class="do">## eps为精度,默认取1e-9</span></span>
<span id="cb118-6"><a href="#cb118-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb118-7"><a href="#cb118-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stopifnot</span>(<span class="fu">is.vector</span>(a)) <span class="co">#当a不为向量时报错</span></span>
<span id="cb118-8"><a href="#cb118-8" aria-hidden="true" tabindex="-1"></a>  d<span class="ot">&lt;-</span><span class="fu">length</span>(a)            <span class="co">#d为a的维度</span></span>
<span id="cb118-9"><a href="#cb118-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb118-10"><a href="#cb118-10" aria-hidden="true" tabindex="-1"></a>  an<span class="ot">&lt;-</span><span class="fu">sqrt</span>(<span class="fu">sum</span>(a<span class="sc">^</span><span class="dv">2</span>))      <span class="co">#当a的模长为0时,输出0</span></span>
<span id="cb118-11"><a href="#cb118-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb118-12"><a href="#cb118-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(an<span class="sc">==</span><span class="dv">0</span>) <span class="fu">return</span> ((<span class="fu">list</span>(<span class="at">res=</span><span class="dv">0</span>,<span class="at">k=</span><span class="dv">0</span>)))</span>
<span id="cb118-13"><a href="#cb118-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span>{</span>
<span id="cb118-14"><a href="#cb118-14" aria-hidden="true" tabindex="-1"></a>    <span class="do">## 注意到k!=gamma(k-1),k&gt;=2时成立</span></span>
<span id="cb118-15"><a href="#cb118-15" aria-hidden="true" tabindex="-1"></a>    <span class="do">## k=0,1时,k!=1,故将k=0,1情形单独列出</span></span>
<span id="cb118-16"><a href="#cb118-16" aria-hidden="true" tabindex="-1"></a>     <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>){</span>
<span id="cb118-17"><a href="#cb118-17" aria-hidden="true" tabindex="-1"></a>    temp1<span class="ot">&lt;-</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">log</span>(an)<span class="sc">+</span><span class="fu">lgamma</span>((d<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">lgamma</span>(k<span class="sc">+</span><span class="dv">3</span><span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb118-18"><a href="#cb118-18" aria-hidden="true" tabindex="-1"></a>    temp2<span class="ot">&lt;-</span>k<span class="sc">*</span><span class="fu">log</span>(<span class="dv">2</span>)<span class="sc">+</span><span class="fu">log</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">+</span><span class="fu">log</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">lgamma</span>(k<span class="sc">+</span>d<span class="sc">/</span><span class="dv">2</span><span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb118-19"><a href="#cb118-19" aria-hidden="true" tabindex="-1"></a>    temp<span class="ot">&lt;-</span><span class="fu">exp</span>(temp1<span class="sc">-</span>temp2)</span>
<span id="cb118-20"><a href="#cb118-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(temp<span class="sc">&lt;=</span>eps) {</span>
<span id="cb118-21"><a href="#cb118-21" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb118-22"><a href="#cb118-22" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">res=</span>temp,<span class="at">k=</span>k))</span>
<span id="cb118-23"><a href="#cb118-23" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb118-24"><a href="#cb118-24" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb118-25"><a href="#cb118-25" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb118-26"><a href="#cb118-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>n){</span>
<span id="cb118-27"><a href="#cb118-27" aria-hidden="true" tabindex="-1"></a>    temp1<span class="ot">&lt;-</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">log</span>(an)<span class="sc">+</span><span class="fu">lgamma</span>((d<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">lgamma</span>(k<span class="sc">+</span><span class="dv">3</span><span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb118-28"><a href="#cb118-28" aria-hidden="true" tabindex="-1"></a>    temp2<span class="ot">&lt;-</span><span class="fu">lgamma</span>(k<span class="dv">-1</span>)<span class="sc">+</span>k<span class="sc">*</span><span class="fu">log</span>(<span class="dv">2</span>)<span class="sc">+</span><span class="fu">log</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">+</span><span class="fu">log</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">lgamma</span>(k<span class="sc">+</span>d<span class="sc">/</span><span class="dv">2</span><span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb118-29"><a href="#cb118-29" aria-hidden="true" tabindex="-1"></a>    temp<span class="ot">&lt;-</span><span class="fu">exp</span>(temp1<span class="sc">-</span>temp2)</span>
<span id="cb118-30"><a href="#cb118-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(temp<span class="sc">&lt;=</span>eps) {</span>
<span id="cb118-31"><a href="#cb118-31" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(plot<span class="sc">==</span><span class="st">&quot;TRUE&quot;</span>)</span>
<span id="cb118-32"><a href="#cb118-32" aria-hidden="true" tabindex="-1"></a>     { <span class="fu">cat</span>(<span class="fu">c</span>(<span class="st">&quot;d=&quot;</span>,d,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>))</span>
<span id="cb118-33"><a href="#cb118-33" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="fu">c</span>(<span class="st">&quot;the Euclidean norm of a=&quot;</span>,<span class="fu">sqrt</span>(<span class="fu">sum</span>(a<span class="sc">^</span><span class="dv">2</span>)),<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>))</span>
<span id="cb118-34"><a href="#cb118-34" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="fu">c</span>(<span class="st">&quot;k=&quot;</span>,k,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>))</span>
<span id="cb118-35"><a href="#cb118-35" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="st">&quot;converge</span><span class="sc">\n</span><span class="st">&quot;</span>)}</span>
<span id="cb118-36"><a href="#cb118-36" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">res=</span>temp,<span class="at">k=</span>k))</span>
<span id="cb118-37"><a href="#cb118-37" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb118-38"><a href="#cb118-38" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb118-39"><a href="#cb118-39" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb118-40"><a href="#cb118-40" aria-hidden="true" tabindex="-1"></a>    <span class="co">#for循环正常结束,次数说明迭代次数较少,可能需要增加n的初始值</span></span>
<span id="cb118-41"><a href="#cb118-41" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">&quot;did not converge</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb118-42"><a href="#cb118-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">res=</span>temp,<span class="at">k=</span>k))</span>
<span id="cb118-43"><a href="#cb118-43" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb118-44"><a href="#cb118-44" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb118-45"><a href="#cb118-45" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>考虑极限情形，此时<span class="math inline">\(\max{a_{(i)}}&lt;=3,\)</span>,欧式模长未发散的情形下的最大维度<span class="math inline">\(d\)</span>,与迭代次数<span class="math inline">\(k\)</span> 分别取 <span class="math display">\[
\begin{aligned}
a_1&amp;\in \mathbb{R}^{d_1},d_1=2\times10^6\\
a_2&amp;\in \mathbb{R}^{d_2},d_1=3\times10^6\\
\end{aligned}
\]</span></p>
<ol start="2" style="list-style-type: decimal">
<li></li>
</ol>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>ff<span class="ot">&lt;-</span><span class="cf">function</span>(a,<span class="at">n=</span><span class="fl">1e5</span>,<span class="at">eps=</span><span class="fl">1e-9</span>)</span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stopifnot</span>(<span class="fu">is.vector</span>(a))</span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a>  d<span class="ot">&lt;-</span><span class="fu">length</span>(a)</span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true" tabindex="-1"></a>  res<span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb119-6"><a href="#cb119-6" aria-hidden="true" tabindex="-1"></a>  an<span class="ot">&lt;-</span><span class="fu">sqrt</span>(<span class="fu">sum</span>(a<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb119-7"><a href="#cb119-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(an<span class="sc">==</span><span class="dv">0</span>) <span class="fu">return</span> (<span class="dv">0</span>)</span>
<span id="cb119-8"><a href="#cb119-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span>{</span>
<span id="cb119-9"><a href="#cb119-9" aria-hidden="true" tabindex="-1"></a>     <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>){</span>
<span id="cb119-10"><a href="#cb119-10" aria-hidden="true" tabindex="-1"></a>    temp1<span class="ot">&lt;-</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">log</span>(an)<span class="sc">+</span><span class="fu">lgamma</span>((d<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">lgamma</span>(k<span class="sc">+</span><span class="dv">3</span><span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb119-11"><a href="#cb119-11" aria-hidden="true" tabindex="-1"></a>    temp2<span class="ot">&lt;-</span>k<span class="sc">*</span><span class="fu">log</span>(<span class="dv">2</span>)<span class="sc">+</span><span class="fu">log</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">+</span><span class="fu">log</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">lgamma</span>(k<span class="sc">+</span>d<span class="sc">/</span><span class="dv">2</span><span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb119-12"><a href="#cb119-12" aria-hidden="true" tabindex="-1"></a>    temp<span class="ot">&lt;-</span><span class="fu">exp</span>(temp1<span class="sc">-</span>temp2)</span>
<span id="cb119-13"><a href="#cb119-13" aria-hidden="true" tabindex="-1"></a>    res<span class="ot">&lt;-</span>res<span class="sc">+</span>(<span class="sc">-</span><span class="dv">1</span>)<span class="sc">^</span>k<span class="sc">*</span>temp</span>
<span id="cb119-14"><a href="#cb119-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(temp<span class="sc">&lt;=</span>eps) {</span>
<span id="cb119-15"><a href="#cb119-15" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="fu">c</span>(<span class="st">&quot;k=&quot;</span>,k,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>))</span>
<span id="cb119-16"><a href="#cb119-16" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="st">&quot;converge</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb119-17"><a href="#cb119-17" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(res)</span>
<span id="cb119-18"><a href="#cb119-18" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb119-19"><a href="#cb119-19" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb119-20"><a href="#cb119-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb119-21"><a href="#cb119-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>n){</span>
<span id="cb119-22"><a href="#cb119-22" aria-hidden="true" tabindex="-1"></a>    temp1<span class="ot">&lt;-</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">log</span>(an)<span class="sc">+</span><span class="fu">lgamma</span>((d<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">lgamma</span>(k<span class="sc">+</span><span class="dv">3</span><span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb119-23"><a href="#cb119-23" aria-hidden="true" tabindex="-1"></a>    temp2<span class="ot">&lt;-</span><span class="fu">lgamma</span>(k<span class="dv">-1</span>)<span class="sc">+</span>k<span class="sc">*</span><span class="fu">log</span>(<span class="dv">2</span>)<span class="sc">+</span><span class="fu">log</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">+</span><span class="fu">log</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">lgamma</span>(k<span class="sc">+</span>d<span class="sc">/</span><span class="dv">2</span><span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb119-24"><a href="#cb119-24" aria-hidden="true" tabindex="-1"></a>    temp<span class="ot">&lt;-</span><span class="fu">exp</span>(temp1<span class="sc">-</span>temp2)</span>
<span id="cb119-25"><a href="#cb119-25" aria-hidden="true" tabindex="-1"></a>    res<span class="ot">&lt;-</span>res<span class="sc">+</span>(<span class="sc">-</span><span class="dv">1</span>)<span class="sc">^</span>k<span class="sc">*</span>temp</span>
<span id="cb119-26"><a href="#cb119-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(temp<span class="sc">&lt;=</span>eps) {</span>
<span id="cb119-27"><a href="#cb119-27" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="fu">c</span>(<span class="st">&quot;k=&quot;</span>,k,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>))</span>
<span id="cb119-28"><a href="#cb119-28" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="st">&quot;converge</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb119-29"><a href="#cb119-29" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(res)</span>
<span id="cb119-30"><a href="#cb119-30" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb119-31"><a href="#cb119-31" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb119-32"><a href="#cb119-32" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb119-33"><a href="#cb119-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">&quot;did not converge</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb119-34"><a href="#cb119-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(res)</span>
<span id="cb119-35"><a href="#cb119-35" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb119-36"><a href="#cb119-36" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb119-37"><a href="#cb119-37" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>a<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">4</span>,.<span class="dv">01</span>)</span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ff</span>(a)</span></code></pre></div>
<pre><code>## k= 2141 
## converge</code></pre>
<pre><code>## [1] -1.107445e+224</code></pre>
<ol start="3" style="list-style-type: decimal">
<li></li>
</ol>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>a<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ff</span>(a)</span></code></pre></div>
<pre><code>## k= 18 
## converge</code></pre>
<pre><code>## [1] 1.530156</code></pre>
<div id="exercise-11.4" class="section level4">
<h4>Exercise 11.4</h4>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>SS<span class="ot">&lt;-</span><span class="cf">function</span>(a,k){</span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stopifnot</span>(k<span class="sc">&gt;</span><span class="dv">1</span>)</span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a>  n<span class="ot">&lt;-</span><span class="fu">length</span>(a)</span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a>  res<span class="ot">&lt;-</span><span class="fu">numeric</span>(n)</span>
<span id="cb126-5"><a href="#cb126-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb126-6"><a href="#cb126-6" aria-hidden="true" tabindex="-1"></a>     <span class="cf">if</span>(<span class="fu">abs</span>(a[i]<span class="sc">^</span><span class="dv">2</span><span class="sc">-</span>k<span class="dv">-1</span>)<span class="sc">&lt;</span><span class="fl">1e-7</span>) res[i]<span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb126-7"><a href="#cb126-7" aria-hidden="true" tabindex="-1"></a>      <span class="cf">else</span>{</span>
<span id="cb126-8"><a href="#cb126-8" aria-hidden="true" tabindex="-1"></a>          temp<span class="ot">&lt;-</span><span class="fu">sqrt</span>(a[i]<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>k<span class="sc">/</span>(k<span class="sc">+</span><span class="dv">1</span><span class="sc">-</span>a[i]<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb126-9"><a href="#cb126-9" aria-hidden="true" tabindex="-1"></a>          res[i]<span class="ot">&lt;-</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">pt</span>(temp,<span class="at">df=</span>k))</span>
<span id="cb126-10"><a href="#cb126-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb126-11"><a href="#cb126-11" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb126-12"><a href="#cb126-12" aria-hidden="true" tabindex="-1"></a> <span class="fu">return</span>(res)</span>
<span id="cb126-13"><a href="#cb126-13" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>以k=4,25,100为例，可以看出<span class="math inline">\(S_k(x)-S_{k-1}(x)\)</span>是偶函数，因此，仅需要考虑<span class="math inline">\(x&lt;0\)</span>的情形</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(k <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">25</span>,<span class="dv">100</span>)){</span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>  aa<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="sc">-</span><span class="fu">sqrt</span>(k),<span class="fu">sqrt</span>(k),<span class="fl">1e-2</span>)</span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(aa,<span class="fu">SS</span>(aa,k)<span class="sc">-</span><span class="fu">SS</span>(aa,k<span class="dv">-1</span>),<span class="at">ylab=</span><span class="st">&quot;&quot;</span>,<span class="at">type=</span><span class="st">&quot;l&quot;</span>)</span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>)</span>
<span id="cb127-5"><a href="#cb127-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a>kk<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">4</span><span class="sc">:</span><span class="dv">25</span>,<span class="dv">100</span>,<span class="dv">500</span>,<span class="dv">1000</span>)</span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a>root<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow =</span> <span class="fu">length</span>(kk),<span class="at">ncol =</span> <span class="dv">3</span>)</span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a>root[,<span class="dv">1</span>]<span class="ot">&lt;-</span>kk</span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(root)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;k&quot;</span>,<span class="st">&quot;root_negative&quot;</span>,<span class="st">&quot;root_positive&quot;</span>)</span>
<span id="cb128-5"><a href="#cb128-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span>  <span class="dv">1</span><span class="sc">:</span> <span class="fu">length</span>(kk)){</span>
<span id="cb128-6"><a href="#cb128-6" aria-hidden="true" tabindex="-1"></a>  dsa<span class="ot">&lt;-</span><span class="cf">function</span>(a){</span>
<span id="cb128-7"><a href="#cb128-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">SS</span>(a,kk[i])<span class="sc">-</span><span class="fu">SS</span>(a,kk[i]<span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb128-8"><a href="#cb128-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb128-9"><a href="#cb128-9" aria-hidden="true" tabindex="-1"></a>a<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="sc">-</span><span class="fu">sqrt</span>(kk[i]),<span class="dv">0</span>,<span class="fl">1e-3</span>)</span>
<span id="cb128-10"><a href="#cb128-10" aria-hidden="true" tabindex="-1"></a>d1<span class="ot">&lt;-</span><span class="fu">which.max</span>(<span class="fu">dsa</span>(a))</span>
<span id="cb128-11"><a href="#cb128-11" aria-hidden="true" tabindex="-1"></a>d2<span class="ot">&lt;-</span><span class="fu">which.min</span>(<span class="fu">dsa</span>(a))</span>
<span id="cb128-12"><a href="#cb128-12" aria-hidden="true" tabindex="-1"></a>res<span class="ot">&lt;-</span><span class="fu">uniroot</span>(dsa, <span class="fu">sort</span>(a[<span class="fu">c</span>(d1,d2)]))</span>
<span id="cb128-13"><a href="#cb128-13" aria-hidden="true" tabindex="-1"></a>root[i,<span class="dv">2</span>]<span class="ot">=</span><span class="fu">unlist</span>(res[<span class="dv">1</span>])</span>
<span id="cb128-14"><a href="#cb128-14" aria-hidden="true" tabindex="-1"></a>root[i,<span class="dv">3</span>]<span class="ot">&lt;-</span><span class="fu">abs</span>(root[i,<span class="dv">2</span>])</span>
<span id="cb128-15"><a href="#cb128-15" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">k</th>
<th align="right">root_negative</th>
<th align="right">root_positive</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">4</td>
<td align="right">-1.492103</td>
<td align="right">1.492103</td>
</tr>
<tr class="even">
<td align="right">5</td>
<td align="right">-1.533559</td>
<td align="right">1.533559</td>
</tr>
<tr class="odd">
<td align="right">6</td>
<td align="right">-1.562745</td>
<td align="right">1.562745</td>
</tr>
<tr class="even">
<td align="right">7</td>
<td align="right">-1.584431</td>
<td align="right">1.584431</td>
</tr>
<tr class="odd">
<td align="right">8</td>
<td align="right">-1.601203</td>
<td align="right">1.601203</td>
</tr>
<tr class="even">
<td align="right">9</td>
<td align="right">-1.614516</td>
<td align="right">1.614516</td>
</tr>
<tr class="odd">
<td align="right">10</td>
<td align="right">-1.625383</td>
<td align="right">1.625383</td>
</tr>
<tr class="even">
<td align="right">11</td>
<td align="right">-1.634414</td>
<td align="right">1.634414</td>
</tr>
<tr class="odd">
<td align="right">12</td>
<td align="right">-1.642036</td>
<td align="right">1.642036</td>
</tr>
<tr class="even">
<td align="right">13</td>
<td align="right">-1.648556</td>
<td align="right">1.648556</td>
</tr>
<tr class="odd">
<td align="right">14</td>
<td align="right">-1.654198</td>
<td align="right">1.654198</td>
</tr>
<tr class="even">
<td align="right">15</td>
<td align="right">-1.659068</td>
<td align="right">1.659068</td>
</tr>
<tr class="odd">
<td align="right">16</td>
<td align="right">-1.663414</td>
<td align="right">1.663414</td>
</tr>
<tr class="even">
<td align="right">17</td>
<td align="right">-1.667274</td>
<td align="right">1.667274</td>
</tr>
<tr class="odd">
<td align="right">18</td>
<td align="right">-1.670724</td>
<td align="right">1.670724</td>
</tr>
<tr class="even">
<td align="right">19</td>
<td align="right">-1.673817</td>
<td align="right">1.673817</td>
</tr>
<tr class="odd">
<td align="right">20</td>
<td align="right">-1.676614</td>
<td align="right">1.676614</td>
</tr>
<tr class="even">
<td align="right">21</td>
<td align="right">-1.679154</td>
<td align="right">1.679154</td>
</tr>
<tr class="odd">
<td align="right">22</td>
<td align="right">-1.681472</td>
<td align="right">1.681472</td>
</tr>
<tr class="even">
<td align="right">23</td>
<td align="right">-1.683594</td>
<td align="right">1.683594</td>
</tr>
<tr class="odd">
<td align="right">24</td>
<td align="right">-1.685546</td>
<td align="right">1.685546</td>
</tr>
<tr class="even">
<td align="right">25</td>
<td align="right">-1.687347</td>
<td align="right">1.687347</td>
</tr>
<tr class="odd">
<td align="right">100</td>
<td align="right">-1.720604</td>
<td align="right">1.720604</td>
</tr>
<tr class="even">
<td align="right">500</td>
<td align="right">-1.729753</td>
<td align="right">1.729753</td>
</tr>
<tr class="odd">
<td align="right">1000</td>
<td align="right">-1.730905</td>
<td align="right">1.730905</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="exercise-11.5" class="section level3">
<h3>EXERCISE 11.5</h3>
<p>Write a function to solve the equation <span class="math display">\[
\begin{aligned}
&amp;\frac{2\Gamma(\frac{k}{2})}{\sqrt{\pi(k-1)}\Gamma(\frac{k-1}{2})}\int_0^{c_{k-1}}(1+\frac{u^2}{k-1})^{-k/2}du\\
=&amp;\frac{2\Gamma(\frac{k+1}{2})}{\sqrt{\pi k}\Gamma(\frac{k}{2})}\int_0^{c_k}(1+\frac{u^2}{k})^{-(k+1)/2}du
\end{aligned}
\]</span> for a, where <span class="math display">\[
c_k=\sqrt{\frac{a^2k}{k+1-a^2}}.
\]</span></p>
<p>Compare the solutions with the points <span class="math inline">\(A(k)\)</span> in Exercise 11.4.</p>
<p>注意到，等式左边 <span class="math display">\[
\begin{aligned}
&amp;\frac{2\Gamma(\frac{k}{2})}{\sqrt{\pi(k-1)}\Gamma(\frac{k-1}{2})}\int_0^{c_{k-1}}(1+\frac{u^2}{k-1})^{-k/2}du\\
=&amp;\frac{\Gamma(\frac{k}{2})}{\sqrt{\pi(k-1)}\Gamma(\frac{k-1}{2})}\int_{-c_{k-1}}^{c_{k-1}}(1+\frac{u^2}{k-1})^{-k/2}du\\
=&amp;P(-c_{k-1}\leq t(k-1)\leq c_{k-1})\\
=&amp;1-2S_{k-1}(a)
\end{aligned}
\]</span> 类似地 <span class="math display">\[
\begin{aligned}
&amp;\frac{2\Gamma(\frac{k+1}{2})}{\sqrt{\pi k}\Gamma(\frac{k}{2})}\int_0^{c_k}(1+\frac{u^2}{k})^{-(k+1)/2}du\\
=&amp;P(-c_{k}\leq t(k)\leq c_{k})\\
=&amp;1-2S_{k}(a)
\end{aligned}
\]</span></p>
<p>即解 <span class="math display">\[
S_{k}(a)=S_{k-1}(a), \ a\in(0,\sqrt{k})
\]</span> 故请见EXERCISE 11.4</p>
</div>
<div id="supplementary-1" class="section level3">
<h3>Supplementary</h3>
<p>Suppose <span class="math inline">\(T_1,\cdots,T_n\)</span> are <span class="math inline">\(i.i.d.\)</span> samples drawn from the exponential distribution with expectation <span class="math inline">\(\lambda\)</span>. Those valuesgreater than τ are not observed due to right censorship, so that the observed values are <span class="math inline">\(Y_i=T_iI(T_i\leq\tau)+\tau I(T_i&gt;\tau),i=1,\cdots,n.\)</span>Suppose $= 1 $and the observed <span class="math inline">\(Y_i\)</span> values are as follows:</p>
<p><span class="math display">\[0.54, 0.48, 0.33, 0.43, 1.00, 1.00, 0.91, 1.00, 0.21, 0.85\]</span> Use the E-M algorithm to estimate <span class="math inline">\(\lambda\)</span>, compare your result with the observed data MLE (note: <span class="math inline">\(Y_i\)</span> follows a mixture distribution).</p>
<p>记<span class="math inline">\(E_i=I(T_i&gt;\tau)\)</span>,则</p>
<p><span class="math display">\[E_i|\lambda\sim B(1,p),\quad p=P(T&gt;1|\lambda)=1-F(1|\lambda)=e^{-\frac{1}{\lambda}} ,\quad i=1,\cdots,m\]</span> 观测到的<span class="math inline">\(E_i\)</span>数据为 <span class="math display">\[
(0,0,0,0,1,1,0,1,0,0)
\]</span> 记 <span class="math display">\[
\begin{aligned}
&amp;K_i=T_i(1-E_i)\\
&amp;M_i=T_iE_i
\end{aligned}
\]</span> 则 <span class="math display">\[
T_i=K_i+M_i
\]</span></p>
<p>而 <span class="math display">\[
f(t|\lambda)=\frac{1}{\lambda}e^{-\frac{1}{\lambda}t}I(t&gt;0)
\]</span></p>
<p>似然函数为</p>
<p><span class="math display">\[
f(\boldsymbol{k,m}|\lambda)\propto\lambda^{-n} e^{-\sum_{i=1}^nt_i/\lambda}=\lambda^{-n} e^{-\sum_{i=1}^n(k_i+m_i)/\lambda}
\]</span></p>
<p>E-M算法中的E步为 <span class="math display">\[
Q(\lambda,\hat{\lambda}^{(i)})=-n\ln \lambda-(\sum_{i=1}^nk_i)/\lambda- E(\sum_{j=1}^nm_j|\boldsymbol{E},\hat{\lambda}^{(i)})/\lambda
\]</span> 其中<span class="math inline">\(m_j|E_j,\hat{\lambda}^{(i)}\)</span>的密度函数为</p>
<p><span class="math display">\[
f_{m_j}(m|E_j,\hat{\theta}^{(i)})=1/\hat{\lambda}^{(i)}e^{-1/\hat{\lambda}^{(i)}m}(E_jI(m&gt;1))/p
\]</span></p>
<p>故均值为 <span class="math display">\[
E^*_j(\hat{\lambda}^{(i)}):=E(m_j|E_j,\hat{\lambda}^{(i)})=E_j(1+\hat{\lambda}^{(i)})e^{-1/\hat{\lambda}^{(i)}}/p=E_j(1+\hat{\lambda}^{(i)})
\]</span></p>
<p><span class="math display">\[
Q(\lambda,\hat{\lambda}^{(i)})=-n\ln \lambda-\sum_{i=1}^nk_i/\lambda- \sum_{j=1}^nE^*_j(\hat{\lambda}^{(i)})/\lambda
\]</span></p>
<p>从而 <span class="math display">\[
\hat{\lambda}^{(i+1)}=\frac{\sum_{i=1}^nk_i+\sum_{j=1}^nE^*_j(\hat{\lambda}^{(i)})}{n}
\]</span></p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a>da<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fl">0.54</span>, <span class="fl">0.48</span>, <span class="fl">0.33</span>, <span class="fl">0.43</span>, <span class="fl">1.00</span>, <span class="fl">1.00</span>, <span class="fl">0.91</span>, <span class="fl">1.00</span>, <span class="fl">0.21</span>, <span class="fl">0.85</span>)</span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>k<span class="ot">&lt;-</span><span class="fu">ifelse</span>(da<span class="sc">&lt;</span><span class="dv">1</span>,da,<span class="dv">0</span>)</span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="fu">length</span>(da)</span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a>n_e<span class="ot">&lt;-</span>n<span class="sc">-</span><span class="fu">sum</span>(da<span class="sc">&lt;</span><span class="dv">1</span>)</span>
<span id="cb129-5"><a href="#cb129-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-6"><a href="#cb129-6" aria-hidden="true" tabindex="-1"></a>estar<span class="ot">&lt;-</span><span class="cf">function</span>(lambda){</span>
<span id="cb129-7"><a href="#cb129-7" aria-hidden="true" tabindex="-1"></a> <span class="fu">return</span>(n_e<span class="sc">*</span>(<span class="dv">1</span><span class="sc">+</span>lambda))</span>
<span id="cb129-8"><a href="#cb129-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb129-9"><a href="#cb129-9" aria-hidden="true" tabindex="-1"></a>EM<span class="ot">&lt;-</span><span class="cf">function</span>(k,n,<span class="at">max.it=</span><span class="fl">1e4</span>,<span class="at">eps=</span><span class="fl">1e-7</span>)</span>
<span id="cb129-10"><a href="#cb129-10" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb129-11"><a href="#cb129-11" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb129-12"><a href="#cb129-12" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb129-13"><a href="#cb129-13" aria-hidden="true" tabindex="-1"></a>  i<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb129-14"><a href="#cb129-14" aria-hidden="true" tabindex="-1"></a>  lambda1<span class="ot">&lt;-</span><span class="dv">5</span></span>
<span id="cb129-15"><a href="#cb129-15" aria-hidden="true" tabindex="-1"></a>  lambda2<span class="ot">&lt;-</span><span class="dv">2</span></span>
<span id="cb129-16"><a href="#cb129-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb129-17"><a href="#cb129-17" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span>(<span class="fu">abs</span>(lambda1<span class="sc">-</span>lambda2)<span class="sc">&gt;=</span>eps){</span>
<span id="cb129-18"><a href="#cb129-18" aria-hidden="true" tabindex="-1"></a>    lambda1<span class="ot">&lt;-</span>lambda2</span>
<span id="cb129-19"><a href="#cb129-19" aria-hidden="true" tabindex="-1"></a>    lambda2<span class="ot">&lt;-</span>(<span class="fu">sum</span>(k)<span class="sc">+</span><span class="fu">estar</span>(<span class="at">lambda=</span>lambda2))<span class="sc">/</span>(n)</span>
<span id="cb129-20"><a href="#cb129-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">round</span>(<span class="fu">c</span>(lambda2),<span class="dv">5</span>))</span>
<span id="cb129-21"><a href="#cb129-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(i <span class="sc">==</span> max.it) <span class="cf">break</span></span>
<span id="cb129-22"><a href="#cb129-22" aria-hidden="true" tabindex="-1"></a>    i<span class="sc">&lt;</span>i<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb129-23"><a href="#cb129-23" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb129-24"><a href="#cb129-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(lambda2)</span>
<span id="cb129-25"><a href="#cb129-25" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb129-26"><a href="#cb129-26" aria-hidden="true" tabindex="-1"></a><span class="fu">EM</span>(<span class="at">k=</span>k,<span class="at">n=</span>n)</span></code></pre></div>
<pre><code>## [1] 1.275
## [1] 1.0575
## [1] 0.99225
## [1] 0.97267
## [1] 0.9668
## [1] 0.96504
## [1] 0.96451
## [1] 0.96435
## [1] 0.96431
## [1] 0.96429
## [1] 0.96429
## [1] 0.96429
## [1] 0.96429
## [1] 0.96429
## [1] 0.96429</code></pre>
<pre><code>## [1] 0.9642857</code></pre>
<p>考虑<span class="math inline">\(Y_i\)</span>的分布函数</p>
<p><span class="math display">\[
\begin{aligned}
P(Y_i\leq x)=&amp;P(Y_i\leq x|E_i=1)P(E_i=1)+P(Y_i\leq x|E_i=0)P(E_i=0)\\
=&amp;P(1\leq x)p+P(T_i\leq x|T_i\leq 1)(1-p)\\
=&amp;I(x\geq 1)p+[\frac{1-e^{-x/\lambda}}{1-e^{-1/\lambda}}I(x&lt;1)+I(x\geq1)](1-p)\\
=&amp;I(x\geq 1)+(1-e^{-x/\lambda})I(x&lt;1)
\end{aligned}
\]</span></p>
<p>似然函数 <span class="math display">\[
L(\lambda)=(\Pi_{i=1,E_i=1}^np)\times\Pi_{i=1,E_i=0}^n(e^{-y_i/\lambda}/\lambda)
\]</span> 对数似然函数 <span class="math display">\[
l(\lambda)=\sum_{i=1,E_i=1}^n-1/\lambda+\sum_{i=1,E_i=0}^n(-ln\lambda-y_i/\lambda)
\]</span></p>
<p>解得MLE为 <span class="math display">\[
\lambda=\frac{\sum_{i=1,E_i=1}^n 1+\sum_{i=1,E_i=0}^ny_i}{\sum_{i=1}^n (1-E_i)}
\]</span></p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>(n_e<span class="sc">+</span><span class="fu">sum</span>(k))<span class="sc">/</span>(n<span class="sc">-</span>n_e)</span></code></pre></div>
<pre><code>## [1] 0.9642857</code></pre>
<p>可以看出与EM算法结果完全一致 ## HW9</p>
</div>
<div id="exercises-1" class="section level3">
<h3>11.1.2 Exercises 1</h3>
<ol style="list-style-type: decimal">
<li>Why are the following two invocations of lapply() equivalent?</li>
</ol>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a>trims <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.5</span>)</span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rcauchy</span>(<span class="dv">100</span>)</span>
<span id="cb134-4"><a href="#cb134-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(trims, <span class="cf">function</span>(trim) <span class="fu">mean</span>(x, <span class="at">trim =</span> trim))</span></code></pre></div>
<pre><code>## [[1]]
## [1] 2.614189
## 
## [[2]]
## [1] 0.3893497
## 
## [[3]]
## [1] 0.2359156
## 
## [[4]]
## [1] 0.1303608</code></pre>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(trims, mean, <span class="at">x =</span> x)</span></code></pre></div>
<pre><code>## [[1]]
## [1] 2.614189
## 
## [[2]]
## [1] 0.3893497
## 
## [[3]]
## [1] 0.2359156
## 
## [[4]]
## [1] 0.1303608</code></pre>
<p>解:lapply的输入参数分别是X(一个list),FUN(一个函数),…(其他传入FUN的参数)</p>
<p>lapply的功能是将X的每一项传入FUN,输出一个新list</p>
<p>本题中输入参数均为trims</p>
<p>lapply的第一项调用内，函数项为固定mean函数中的参数x=x,根据trim输出对应的函数值</p>
<p>lapply的第二项调用内，函数项为mean函数,…中的参数x=x,传入mean中,故与第一项调用完全一致，输出相同</p>
</div>
<div id="exercises-5" class="section level3">
<h3>11.1.2 Exercises 5</h3>
<ol start="5" style="list-style-type: decimal">
<li>For each model in the previous two exercises, extract <span class="math inline">\(R^2\)</span> using the function below.</li>
</ol>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a>rsq <span class="ot">&lt;-</span> <span class="cf">function</span>(mod) <span class="fu">summary</span>(mod)<span class="sc">$</span>r.squared</span></code></pre></div>
<div id="exercises-3" class="section level4">
<h4>Exercises 3</h4>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a>formulas <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a>mpg <span class="sc">~</span> disp,</span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a>mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp),</span>
<span id="cb139-4"><a href="#cb139-4" aria-hidden="true" tabindex="-1"></a>mpg <span class="sc">~</span> disp <span class="sc">+</span> wt,</span>
<span id="cb139-5"><a href="#cb139-5" aria-hidden="true" tabindex="-1"></a>mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp) <span class="sc">+</span> wt</span>
<span id="cb139-6"><a href="#cb139-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb139-7"><a href="#cb139-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-8"><a href="#cb139-8" aria-hidden="true" tabindex="-1"></a>mod<span class="ot">&lt;-</span><span class="fu">lapply</span>(formulas, lm,<span class="at">data=</span>mtcars)</span>
<span id="cb139-9"><a href="#cb139-9" aria-hidden="true" tabindex="-1"></a>r2<span class="ot">&lt;-</span><span class="fu">lapply</span>(mod, rsq)</span>
<span id="cb139-10"><a href="#cb139-10" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">unlist</span>(r2),<span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1] 0.718 0.860 0.781 0.884</code></pre>
<p>得到<span class="math inline">\(R^2=(0.718,0.860,0.781,0.884)\)</span></p>
</div>
<div id="exercises-4" class="section level4">
<h4>Exercises 4</h4>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a>bootstraps <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="cf">function</span>(i) {</span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a>rows <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(mtcars), <span class="at">rep =</span> <span class="cn">TRUE</span>)</span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a>mtcars[rows, ]</span>
<span id="cb141-4"><a href="#cb141-4" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb141-5"><a href="#cb141-5" aria-hidden="true" tabindex="-1"></a>mod<span class="ot">&lt;-</span><span class="fu">lapply</span>(bootstraps, lm,<span class="at">formula=</span>mpg <span class="sc">~</span> disp )</span>
<span id="cb141-6"><a href="#cb141-6" aria-hidden="true" tabindex="-1"></a>r2<span class="ot">&lt;-</span><span class="fu">lapply</span>(mod, rsq)</span>
<span id="cb141-7"><a href="#cb141-7" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">unlist</span>(r2),<span class="dv">3</span>)</span></code></pre></div>
<pre><code>##  [1] 0.761 0.816 0.815 0.815 0.662 0.614 0.587 0.718 0.746 0.756</code></pre>
<p><span class="math inline">\(R^2=(0.761,0.816,0.815,0.815,0.662,0.614,0.587,0.718,0.746,0.756)\)</span></p>
</div>
</div>
<div id="exercises-1-1" class="section level3">
<h3>11.2.5 Exercises 1</h3>
<ol style="list-style-type: decimal">
<li>Use vapply() to:</li>
</ol>
<ol style="list-style-type: lower-alpha">
<li>Compute the standard deviation of every column in a numeric data frame.</li>
<li>Compute the standard deviation of every numeric column in a mixed data frame. (Hint: you’ll need to use vapply() twice.)</li>
</ol>
<div id="a" class="section level4">
<h4>a</h4>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a>df<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="fu">replicate</span>(<span class="dv">6</span>,<span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>),<span class="dv">10</span>,<span class="at">rep=</span>T)))</span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">vapply</span>(df, sd,<span class="at">FUN.VALUE =</span> <span class="fu">double</span>(<span class="dv">1</span>)),<span class="dv">3</span>)</span></code></pre></div>
<pre><code>##    X1    X2    X3    X4    X5    X6 
## 2.807 2.121 3.240 2.263 2.119 2.459</code></pre>
</div>
<div id="a-1" class="section level4">
<h4>a</h4>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a>df<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="fu">replicate</span>(<span class="dv">6</span>,<span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>),<span class="dv">10</span>,<span class="at">rep=</span>T)),<span class="at">y=</span><span class="fu">rep</span>(<span class="st">&quot;a&quot;</span>,<span class="dv">10</span>))</span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-4"><a href="#cb145-4" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">vapply</span>(df[<span class="fu">vapply</span>(df, is.integer, <span class="at">FUN.VALUE =</span> <span class="fu">logical</span>(<span class="dv">1</span>))]</span>
<span id="cb145-5"><a href="#cb145-5" aria-hidden="true" tabindex="-1"></a>             , sd,<span class="at">FUN.VALUE =</span> <span class="fu">double</span>(<span class="dv">1</span>)),<span class="dv">3</span>)</span></code></pre></div>
<pre><code>##    X1    X2    X3    X4    X5    X6 
## 2.807 2.121 3.240 2.263 2.119 2.459</code></pre>
</div>
</div>
<div id="exercises-7" class="section level3">
<h3>11.2.5 Exercises 7</h3>
<ol start="7" style="list-style-type: decimal">
<li>Implement mcsapply(), a multicore version of sapply(). Can you implement mcvapply(), a parallel version of vapply()? Why or why not?</li>
</ol>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(parallel)</span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a>nocore<span class="ot">&lt;-</span><span class="fu">detectCores</span>()<span class="sc">-</span><span class="dv">1</span></span>
<span id="cb147-3"><a href="#cb147-3" aria-hidden="true" tabindex="-1"></a>cl<span class="ot">&lt;-</span><span class="fu">makeCluster</span>(nocore)</span></code></pre></div>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a>mcsapply<span class="ot">&lt;-</span><span class="cf">function</span>(<span class="at">cl=</span><span class="fu">makeCluster</span>(<span class="fu">detectCores</span>()<span class="sc">-</span><span class="dv">1</span>),X,FUN){</span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a>  parallel<span class="sc">::</span><span class="fu">parLapply</span>(cl, X, FUN)</span>
<span id="cb148-3"><a href="#cb148-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb148-4"><a href="#cb148-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-5"><a href="#cb148-5" aria-hidden="true" tabindex="-1"></a><span class="fu">mcsapply</span>(cl, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="cf">function</span>(x) x<span class="sc">+</span><span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [[1]]
## [1] 4
## 
## [[2]]
## [1] 5
## 
## [[3]]
## [1] 6
## 
## [[4]]
## [1] 7</code></pre>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a>mcvapply<span class="ot">&lt;-</span><span class="cf">function</span>(<span class="at">cl=</span><span class="fu">makeCluster</span>(<span class="fu">detectCores</span>()<span class="sc">-</span><span class="dv">1</span>),X,FUN,<span class="at">USE.NAMES =</span><span class="cn">TRUE</span>){</span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a> Y<span class="ot">=</span>X[<span class="fu">sapply</span>(X, <span class="cf">function</span>(x) <span class="fu">typeof</span>(x)<span class="sc">==</span><span class="fu">typeof</span>(USE.NAMES))]</span>
<span id="cb150-3"><a href="#cb150-3" aria-hidden="true" tabindex="-1"></a> <span class="cf">if</span>(<span class="fu">length</span>(Y)<span class="sc">==</span><span class="dv">0</span>) <span class="fu">return</span>(<span class="st">&quot;ERROR&quot;</span>)</span>
<span id="cb150-4"><a href="#cb150-4" aria-hidden="true" tabindex="-1"></a> <span class="cf">else</span>(<span class="fu">parLapply</span>(cl, Y, FUN))</span>
<span id="cb150-5"><a href="#cb150-5" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb150-6"><a href="#cb150-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb150-7"><a href="#cb150-7" aria-hidden="true" tabindex="-1"></a><span class="fu">mcvapply</span>(cl, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="cf">function</span>(x) x<span class="sc">+</span><span class="dv">3</span>,<span class="at">USE.NAMES =</span> <span class="fu">integer</span>(<span class="dv">1</span>))</span></code></pre></div>
<pre><code>## [[1]]
## [1] 4
## 
## [[2]]
## [1] 5
## 
## [[3]]
## [1] 6
## 
## [[4]]
## [1] 7</code></pre>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mcvapply</span>(cl, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="cf">function</span>(x) x<span class="sc">+</span><span class="dv">3</span>,<span class="at">USE.NAMES =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## [1] &quot;ERROR&quot;</code></pre>
</div>
</div>
<div id="hw10" class="section level2">
<h2>HW10</h2>
<div id="write-an-rcpp-function-for-exercise-9.8" class="section level3">
<h3>Write an Rcpp function for Exercise 9.8</h3>
<p>This example appears in [40]. Consider the bivariate density <span class="math display">\[
f(x,y)\propto \binom{n}{x}y^{x+a-1}(1-y)^{n-x+b-1},\quad x=0,1,\cdots,n,0\leq y \leq 1.
\]</span> It can be shown (see e.g. [23]) that for fixed <span class="math inline">\(a, b, n\)</span>, the conditional distributions are <span class="math inline">\(Binomial(n, y)\)</span> and <span class="math inline">\(Beta(x+ a, n − x+ b)\)</span>. Use the Gibbs sampler to generate a chain with target joint density <span class="math inline">\(f(x, y).\)</span></p>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a><span class="co">#library(Rcpp)</span></span>
<span id="cb154-3"><a href="#cb154-3" aria-hidden="true" tabindex="-1"></a>Rcpp<span class="sc">::</span><span class="fu">cppFunction</span>(</span>
<span id="cb154-4"><a href="#cb154-4" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;NumericMatrix gibbsC(int N) {</span></span>
<span id="cb154-5"><a href="#cb154-5" aria-hidden="true" tabindex="-1"></a><span class="st">  NumericMatrix mat(N, 2);</span></span>
<span id="cb154-6"><a href="#cb154-6" aria-hidden="true" tabindex="-1"></a><span class="st">  double x = 0, y = 0, a=5,b=4,n=20;</span></span>
<span id="cb154-7"><a href="#cb154-7" aria-hidden="true" tabindex="-1"></a><span class="st">  for(int i = 0; i &lt; N; i++) {</span></span>
<span id="cb154-8"><a href="#cb154-8" aria-hidden="true" tabindex="-1"></a><span class="st">   </span></span>
<span id="cb154-9"><a href="#cb154-9" aria-hidden="true" tabindex="-1"></a><span class="st">      x = rbinom(1,n,y)[0];</span></span>
<span id="cb154-10"><a href="#cb154-10" aria-hidden="true" tabindex="-1"></a><span class="st">      y = rbeta(1,x+a,n-x+b)[0];</span></span>
<span id="cb154-11"><a href="#cb154-11" aria-hidden="true" tabindex="-1"></a><span class="st"> </span></span>
<span id="cb154-12"><a href="#cb154-12" aria-hidden="true" tabindex="-1"></a><span class="st">    mat(i, 0) = x;</span></span>
<span id="cb154-13"><a href="#cb154-13" aria-hidden="true" tabindex="-1"></a><span class="st">    mat(i, 1) = y;</span></span>
<span id="cb154-14"><a href="#cb154-14" aria-hidden="true" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb154-15"><a href="#cb154-15" aria-hidden="true" tabindex="-1"></a><span class="st">  return(mat);</span></span>
<span id="cb154-16"><a href="#cb154-16" aria-hidden="true" tabindex="-1"></a><span class="st">}&#39;</span></span>
<span id="cb154-17"><a href="#cb154-17" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a>data<span class="ot">&lt;-</span><span class="fu">gibbsC</span>(<span class="dv">1000</span>)</span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(data)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="supplement" class="section level3">
<h3>Supplement</h3>
<ul>
<li>Compare the corresponding generated random numbers with pure R language using the function “qqplot”</li>
</ul>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a>Rcpp<span class="sc">::</span><span class="fu">cppFunction</span>(<span class="st">&#39;NumericVector cunif(int n,double min,double max){</span></span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true" tabindex="-1"></a><span class="st">            NumericVector x;</span></span>
<span id="cb156-3"><a href="#cb156-3" aria-hidden="true" tabindex="-1"></a><span class="st">            x=runif(n,min,max);</span></span>
<span id="cb156-4"><a href="#cb156-4" aria-hidden="true" tabindex="-1"></a><span class="st">            return(x);</span></span>
<span id="cb156-5"><a href="#cb156-5" aria-hidden="true" tabindex="-1"></a><span class="st">            }&#39;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a>cc<span class="ot">&lt;-</span><span class="fu">cunif</span>(<span class="at">n=</span><span class="dv">1000</span>,<span class="at">min=</span><span class="sc">-</span><span class="dv">1</span>,<span class="at">max=</span><span class="dv">1</span>)</span>
<span id="cb157-3"><a href="#cb157-3" aria-hidden="true" tabindex="-1"></a>rr<span class="ot">&lt;-</span><span class="fu">runif</span>(<span class="at">n=</span><span class="dv">1000</span>,<span class="at">min=</span><span class="sc">-</span><span class="dv">1</span>,<span class="at">max=</span><span class="dv">1</span>)</span>
<span id="cb157-4"><a href="#cb157-4" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(cc,rr)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<ul>
<li>Campare the computation time of the two functions with the function “microbenchmark”.</li>
</ul>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a> <span class="co">#   library(microbenchmark)</span></span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a>ts <span class="ot">&lt;-</span> microbenchmark<span class="sc">::</span><span class="fu">microbenchmark</span>(cc<span class="ot">&lt;-</span><span class="fu">cunif</span>(<span class="at">n=</span><span class="dv">1000</span>,<span class="at">min=</span><span class="sc">-</span><span class="dv">1</span>,<span class="at">max=</span><span class="dv">1</span>),</span>
<span id="cb158-3"><a href="#cb158-3" aria-hidden="true" tabindex="-1"></a>rr<span class="ot">&lt;-</span><span class="fu">runif</span>(<span class="at">n=</span><span class="dv">1000</span>,<span class="at">min=</span><span class="sc">-</span><span class="dv">1</span>,<span class="at">max=</span><span class="dv">1</span>))</span>
<span id="cb158-4"><a href="#cb158-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summary</span>(ts)[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</span></code></pre></div>
<pre><code>##                                       expr    lq median    uq
## 1 cc &lt;- cunif(n = 1000, min = -1, max = 1) 11.75  14.35 16.65
## 2 rr &lt;- runif(n = 1000, min = -1, max = 1) 41.35  43.50 50.50</code></pre>
<ul>
<li>Comments your results.</li>
</ul>
<p>可以看出使用cpp函数所用时间远小于使用r原生函数，且两方法结果上看一致。</p>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
